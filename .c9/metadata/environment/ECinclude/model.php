{"changed":true,"filter":false,"title":"model.php","tooltip":"/ECinclude/model.php","value":"<?php\n/**\n* 特殊文字をHTMLエンティティに変換する\n* @param str  $str 変換前文字\n* @return str 変換後文字\n*/\nfunction entity_str($str) {\n    return htmlspecialchars($str, ENT_QUOTES, 'utf-8');\n}\n\n/**\n* クエリを実行しその結果を配列で取得する\n*\n* @param obj  $link DBハンドル\n* @param str  $sql SQL文\n* @return array 結果配列データ\n*/\nfunction get_as_array($pdo,$sql) {\n \n    // 返却用配列\n    global $data;\n \n    // クエリを実行する\n    $stmt=$pdo->query($sql);\n \n    while($row=$stmt->fetch()){\n        $data[] = $row;\n    }\n    \n    return $data;\n \n}\n/**\n* リクエストメソッドを取得\n* @return str GET/POST/PUTなど\n*/\nfunction get_request_method() {\n   return $_SERVER['REQUEST_METHOD'];\n}\n/**\n* POSTデータを取得\n* @param str $key 配列キー\n* @return str POST値\n*/\nfunction get_post_data($key) {\n   $str = '';\n   if (isset($_POST[$key]) === TRUE) {\n       $str = $_POST[$key];\n   }\n   return $str;\n}\n \n// 文字入力チェック関数\nfunction iteminfo_input_charcheck($pdo){\n    if ($_SERVER['REQUEST_METHOD'] === 'POST'){\n        global $regexp_price;\n        global $regexp_stock;\n        global $regexp_file;\n        global $date;\n        global $input_err;\n        \n        // 変数初期化\n        $new_name = \"\";\n        $new_price = 0;\n        $new_stock = 0;\n        $new_img = \"\";\n        $filename =\"\";\n        $new_status =0;\n        $uploader = \"./image/\";\n        \n        if(isset($_POST['new_name']) && isset($_POST['new_price']) && isset($_POST['new_stock']) && isset($_POST['new_status'])){\n        \n            // 変数に代入\n            $new_status = $_POST['new_status'];\n            \n            // ＿POSTが空白の場合のエラー\n            if($_POST['new_name'] === \"\"){\n            //   名前が空白\n                $input_err[] = \"名前を入力してください<br>\";\n            }else{\n                $new_name = $_POST['new_name'];\n            }\n           \n            if($_POST['new_price'] === \"\"){\n                //   値段が空白\n                $input_err[] = \"値段を入力してください<br>\";\n                \n            }else{\n                \n               if(!preg_match($regexp_price,$_POST['new_price'])){\n                   //   値段が空白ではないが半角数字ではない\n                   $input_err[] = \"値段は半角数字を入力してください<br>\";\n               }else if($new_price > 10000){\n                   //   値段が空白ではなく半角数字でもあるが１万円以上\n                   $input_err[] = \"値段は1万円以下にして下さい<br>\";\n               }else{\n                   $new_price = $_POST['new_price'];\n               }\n               \n            }\n            \n           if($_POST['new_stock'] === \"\"){\n            //   個数が空白\n                $input_err[] = \"個数を入力してください<br>\";\n           }else{\n               \n               if(!preg_match($regexp_stock,$_POST['new_stock'])){\n                //   個数が空白ではないが半角数字\n                $input_err[] = \"個数は半角数字を入力してください<br>\";\n               }else{\n                $new_stock = $_POST['new_stock'];\n               }\n               \n           }   \n                \n           if(empty($_FILES['new_img']['name'])){\n            //   ファイル名が空白\n               $input_err[] = \"ファイルを選択してください<br>\";\n           }else{\n               if(preg_match($regexp_file,$_FILES['new_img']['name'])){\n             \n            //  保存先のパスとブラウザ上に一時保存された画像名を結合\n               $upload = $uploader . basename($_FILES['new_img']['name']);\n            //   var_dump($upload);\n            \n            //   アップロードされた画像をファイルに保存\n               if(move_uploaded_file($_FILES['new_img']['tmp_name'],$upload) !== TRUE){\n                   $err_msg[] = '保存失敗';\n               };\n               \n            //   画像名を変数に代入\n               $filename = basename($_FILES['new_img']['name']);\n            //   確認用\n            //   var_dump($filename);\n               }else{\n                   $input_err[] = \"ファイル形式が異なります。画像ファイルはJPEG又はPNGのみ利用可能です。\";\n               }\n           }\n           return detail_insert($input_err,$new_name,$new_price,$date,$new_status,$filename,$new_stock,$pdo);\n        }\n    }\n}\n           \n// db接続関数\nfunction get_db_connect() {\n        \n            $username = 'codecamp49497';\n            $passwd = 'codecamp49497';\n        try{\n            // pdoによるMYSQLへの接続\n            $pdo = new PDO('mysql:host=localhost;dbname=codecamp49497;charset=utf8;',$username,$passwd);\n            //例外をスローさせるためのおまじない↓\n            $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);\n            $pdo->setAttribute(PDO::ATTR_EMULATE_PREPARES, false);\n            \n        }catch(PDOException $e){\n            //エラー情報の表示\n            //エラーコード取得\n            $code=$e->getCode();\n            //エラーメッセージ取得\n            $message=$e->getMessage();\n            print '接続失敗しました';\n            print '<br>';\n            print(\"{$code}/{$message}<brS>\");\n            //プログラム終了\n            die();\n        }\n            return $pdo;\n}\n\n// 商品情報追加関数           \nfunction detail_insert($input_err,$new_name,$new_price,$date,$new_status,$filename,$new_stock,$pdo){\n        $data_array =[];\n        // 入力でエラーがない場合\n        if(count($input_err) === 0){\n            try{\n                //例外をスローさせるためのおまじない↓\n                $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);\n                $pdo->setAttribute(PDO::ATTR_EMULATE_PREPARES, false);\n                \n                // トランザクション開始\n                $pdo->beginTransaction();\n                \n                //   アイテム表に行追加\n                $query_detail = \"INSERT INTO item_info_table (name,price,img,status,created_date,updated_date) VALUES(?,?,?,?,?,?)\";\n                $stmt=$pdo->prepare($query_detail);\n                \n                \n                // バインド　以下sqlインジェクション対策\n                $stmt->bindValue(1,$new_name);\n                $stmt->bindValue(2,$new_price);\n                $stmt->bindValue(3,$filename);\n                $stmt->bindValue(4,$new_status);\n                $stmt->bindValue(5,$date);\n                $stmt->bindValue(6,$date);\n                $stmt->execute();\n                \n                \n                // 表作成のためのカラム取得\n                $sql = \"SELECT id FROM item_info_table WHERE created_date = (SELECT MAX(created_date) FROM item_info_table)\";\n        \n                $stmt=$pdo->query($sql);\n    \n                while($row=$stmt->fetch()){\n                    $data_array[] = $row;\n                }\n                var_dump($data_array);\n                $item_id = $data_array[0]['id'];\n                var_dump($item_id);\n                //   在庫表に行追加\n                $query_stock = \"INSERT INTO item_stock_table (stock,created_date,updated_date,item_id) VALUES(?,?,?,?)\";\n                $stmt=$pdo->prepare($query_stock);\n                \n                // バインド　以下sqlインジェクション対策\n                $stmt->bindValue(1,$new_stock);\n                $stmt->bindValue(2,$date);\n                $stmt->bindValue(3,$date);\n                $stmt->bindValue(4,$item_id);\n                $stmt->execute();\n                \n                //コミット\n                $pdo->commit();\n                \n            }catch(PDOException $e){\n                if(isset($pdo)===true && $pdo->inTransaction()===true){\n                    //ロールバックする\n                    $pdo->rollBack();\n                }\n                 \n                //エラー情報の表示\n                //エラーコード取得\n                $code=$e->getCode();\n                 //エラーメッセージ取得\n                $message=$e->getMessage();\n                print 'sql文の実行が失敗しました';\n                print '<br>';\n                print(\"{$code}/{$message}<brS>\");\n                //プログラム終了\n                die();\n            }\n            \n        }else{\n        //   入力エラーある場合エラー内容を表示\n               foreach($input_err as $error){\n                   print $error;\n               }\n        }\n}\n \n//  在庫数変更関数\nfunction stock_change($pdo){\n    global $regexp_stock;\n    \n    if ($_SERVER['REQUEST_METHOD'] === 'POST'){\n        // 在庫数変更\n        if(isset($_POST['update_stock']) && isset($_POST['id'])){\n            if($_POST['update_stock'] === \"\"){\n                //   個数が空白\n                print \"個数を入力してください\";\n            }else if (!preg_match($regexp_stock,$_POST['update_stock'])){\n                //   個数が空白ではないが半角数字\n                 print \"個数は半角数字を入力してください\";\n            }else{\n                // 在庫数変更をデータベースに保存 \n                // if($_POST['update_stock'] && $_POST['id']){\n                // とすると0ならば代入されない\n                \n                $update_stock = $_POST['update_stock'];\n                // 確認用\n                // var_dump($update_stock);\n                \n                $update_drinkid = $_POST['id'];\n                \n                // 在庫数変更クエリ\n                $query = \"UPDATE item_stock_table SET stock = $update_stock WHERE id = $update_drinkid\";\n                // 確認用\n                // var_dump($query);\n                                \n                // クエリを実行します\n                $stmt=$pdo->query($query);\n                    \n            }\n        }\n    }\n}\n\n// ステータス変更関数\nfunction status_change($pdo){\n\n    if ($_SERVER['REQUEST_METHOD'] === 'POST'){\n        // ステータス変更\n        if(isset($_POST[\"change_status\"])){\n            // 現在の公開ステータス\n            $prestatus = $_POST[\"change_status\"];\n            var_dump($prestatus);            \n            // 現在のステータスが0ならば、変更後は１　そうでないなら変更後は0\n            if($prestatus === '0'){\n                $poststatus = '1';\n            }else{\n                $poststatus = '0';\n            }\n            \n            // id取得\n            $update_drinkid = $_POST['id'];\n    \n            // 現在時刻を取得\n            $date = date('Y-m-d H:i:s');\n                            \n            \n            // ステータス変更クエリ\n            $status_query = \"UPDATE item_info_table SET status = '$poststatus' WHERE id = $update_drinkid\";\n            \n            // クエリを実行します\n            $stmt=$pdo->query($status_query);\n            \n            // updated_date更新クエリ\n            $update_date_query = \"UPDATE item_info_table SET updated_date = '$date'\";\n            \n            // クエリを実行します\n            $stmt=$pdo->query($update_date_query);\n            \n            \n        }\n    }\n}\n \n// 管理者ブラウザに表示する表の作成\n function table_display($pdo){\n    $data_array =[];\n    // 表作成のためのカラム取得\n    $sql = \"SELECT item_info_table.id,name,img,price,stock,status FROM item_info_table JOIN item_stock_table ON item_info_table.id = item_stock_table.item_id\";\n    $stmt=$pdo->query($sql);\n    \n    while($row=$stmt->fetch()){\n        $data_array[] = $row;\n    }\n    \n    return $data_array;\n }\n \n function user_table($pdo,$sql){\n     $data =[];\n     $stmt=$pdo->query($sql);\n     while($row=$stmt->fetch()){\n        $data[] = $row;\n    }\n    \n    return $data;\n }\n \n \n \n \n// 以下　管理者画面で使う関数\n\n\n// 投入金額と選択商品のエラー関数\n// function buyer_inputcheck(){\n//     $post_err = [];\n//     global $regexp_price;\n    \n//     if ($_SERVER['REQUEST_METHOD'] === 'POST'){\n    \n        \n//         // 投入金額が入力されていない\n//         if(!$_POST['money']){\n//             print '<p>投入金額を入力してください</p>';\n//             $post_err[] = '投入金額を入力してください';\n//         }else if(!preg_match($regexp_price,$_POST['money'])){\n//             // 投入金額が正規表現外\n//             print  \"<p>投入金額は半角数字を入力してください</p>\";\n//             $post_err[] = \"投入金額は半角数字を入力してください\";\n//         }else if($_POST['money'] > 10000){\n//             // 投入金額が１万以上\n//             print \"<p>投入金額は1万円以下にしてください</p>\";\n//             $post_err[] = \"投入金額は1万円以下にしてください\";\n//         }\n        \n//         // 購入商品が選択されていないときのエラー\n//         if(!$_POST['id']){\n//             print '<p>購入する商品を選択してください</p>';\n//             $post_err[] = '購入する商品を選択してください';\n//         }\n    \n//         return $post_err;\n//     }\n// }\n\n// // 商品削除関数\nfunction delete_iteminfo($pdo){\n    if($_SERVER['REQUEST_METHOD'] === 'POST'){\n        if(isset($_POST['delete'])){\n            // id取得\n            $id = $_POST['id'];\n            // トランザクション開始\n            $pdo->beginTransaction();\n            $sql = \"DELETE FROM item_info_table WHERE id= $id\";\n            $stmt=$pdo->query($sql);\n             //コミット\n            $pdo->commit();\n        }\n    \n    }\n    \n}\n\n// // カートの商品情報取得関数\n// function cart_iteminfo($pdo){\n//     // トランザクション開始\n//     $pdo->beginTransaction();\n        \n//         // 現在時刻を取得\n//         $date = date('Y-m-d H:i:s');\n        \n//         // id取得\n//         $id = $_POST['drink_id'];\n        \n//         // // トランザクション開始\n//         // $pdo->beginTransaction();\n        \n//         // カートに入れた商品情報取得のためのクエリ\n//         $sql = \"SELECT item_info_table.id,name,img,price,stock,status FROM item_info_table JOIN item_stock_table ON item_info_table.id = item_stock_table.id WHERE item_info_table.id = '$id'\";\n        \n//         $stmt=$pdo->query($sql);\n        \n//         // 結果を一行取り出す\n//         while($row=$stmt->fetch()){\n            \n//             // カートに入れたアイテム名取得\n//             $item_name = htmlspecialchars($row['name']);\n                \n//             // カートに入れたアイテムのステータス取得　修正箇所　12/2/'21\n//             $status = htmlspecialchars($row['status']);\n                \n//             // カートに入れたアイテムのstock取得　修正箇所　12/2/'21\n//             $stock = htmlspecialchars($row['stock']);\n                \n//             // カートに入れた商品画像取得　修正箇所　12/2/'21\n//             $image = $row['img'];\n                \n//             // カートに入れた商品価格取得　修正箇所　12/2/'21\n//             $price = $row['price'];\n            \n//         }\n                \n//                \n//  }\n//            \n\n\n// ユーザー名　パスワード　入力チェック\nfunction userinfo_input_charcheck(){\n    if ($_SERVER['REQUEST_METHOD'] === 'POST'){\n        \n        global $regexp_user;\n        global $input_err;\n     \n        \n        if(isset($_POST['user_name']) && isset($_POST['passwd'])){\n            if($_POST['user_name'] === \"\"){\n                //   値段が空白\n                $input_err[] = \"ユーザー名を入力してください<br>\";\n                \n            }else{\n                \n               if(!preg_match($regexp_user,$_POST['user_name'])){\n                   //   値段が空白ではないが半角数字ではない\n                   $input_err[] = \"ユーザー名は半角数字6文字以上で入力してください<br>\";\n               }\n            }\n               \n            if($_POST['passwd'] === \"\"){\n                //   値段が空白\n                $input_err[] = \"パスワードを入力してください<br>\";\n                \n            }else{\n                \n               if(!preg_match($regexp_user,$_POST['passwd'])){\n                   //   値段が空白ではないが半角数字ではない\n                   $input_err[] = \"パスワードは半角数字6文字以上で入力してください<br>\";\n               }\n            }\n        }\n        return $input_err;\n    }     \n}\n\n// 重複したユーザー名があるかどうか調べる関数\nfunction check_same_user ($pdo){\n    global $data;\n    $register_err = [];\n    $username = '';\n    $username = get_post_data('user_name');\n    \n    $sql = \"SELECT * FROM user_info_table WHERE user_name = '$username' \";\n    $data = get_as_array($pdo,$sql);\n    if(!empty($data)){\n        $register_err[] = 'このユーザー名はすでに登録されているため、登録できません<br>';\n    }\n    \n    return $register_err;\n}\n\n// ユーザー登録関数\nfunction user_register($input_err,$register_err,$pdo){\n    global $date;\n    $new_user = '';\n    $new_pass = '';\n     // 上記2つの関数でエラーがない場合\n     if($_SERVER['REQUEST_METHOD'] === 'POST'){\n        if(count($input_err) === 0 && count($register_err) === 0){\n            try{\n                \n                $new_user = get_post_data('user_name');\n                $new_pass = get_post_data('passwd');\n                    \n                   \n                $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);\n                $pdo->setAttribute(PDO::ATTR_EMULATE_PREPARES, false);\n                    \n                // トランザクション開始\n                $pdo->beginTransaction();\n                    \n                //   user_info表に行追加\n                $query_detail = \"INSERT INTO user_info_table (user_name,password,created_date,updated_date) VALUES(?,?,?,?)\";\n                $stmt=$pdo->prepare($query_detail);\n                    \n                    \n                // バインド　以下sqlインジェクション対策\n                $stmt->bindValue(1,$new_user);\n                $stmt->bindValue(2,$new_pass);\n                $stmt->bindValue(3,$date);\n                $stmt->bindValue(4,$date);\n                \n                $stmt->execute();\n                    \n                    \n                //コミット\n                $pdo->commit();\n                    \n                print '登録完了しました';\n                \n                \n            }catch(PDOException $e){\n                if(isset($pdo)===true && $pdo->inTransaction()===true){\n                    //ロールバックする\n                    $pdo->rollBack();\n                }\n                 \n                //エラー情報の表示\n                //エラーコード取得\n                $code=$e->getCode();\n                 //エラーメッセージ取得\n                $message=$e->getMessage();\n                \n                print 'sql文の実行が失敗しました';\n                print '<br>';\n                print(\"{$code}/{$message}<brS>\");\n                //プログラム終了\n                die();\n            }\n        }else{\n            foreach($input_err as $go){\n                print $go;\n            }\n            foreach($register_err as $go){\n                print $go;\n            }\n        }\n    }\n}\n\n\n \n","undoManager":{"mark":-5,"position":100,"stack":[[{"start":{"row":199,"column":65},"end":{"row":199,"column":66},"action":"insert","lines":[" "],"id":229}],[{"start":{"row":199,"column":66},"end":{"row":199,"column":67},"action":"insert","lines":["c"],"id":230},{"start":{"row":199,"column":67},"end":{"row":199,"column":68},"action":"insert","lines":["r"]}],[{"start":{"row":199,"column":66},"end":{"row":199,"column":68},"action":"remove","lines":["cr"],"id":231},{"start":{"row":199,"column":66},"end":{"row":199,"column":78},"action":"insert","lines":["created_date"]}],[{"start":{"row":199,"column":78},"end":{"row":199,"column":79},"action":"insert","lines":[" "],"id":232},{"start":{"row":199,"column":79},"end":{"row":199,"column":80},"action":"insert","lines":["="]}],[{"start":{"row":199,"column":80},"end":{"row":199,"column":81},"action":"insert","lines":["("],"id":233},{"start":{"row":199,"column":81},"end":{"row":199,"column":82},"action":"insert","lines":[")"]}],[{"start":{"row":199,"column":80},"end":{"row":199,"column":81},"action":"insert","lines":[" "],"id":234}],[{"start":{"row":199,"column":82},"end":{"row":199,"column":83},"action":"insert","lines":["S"],"id":235},{"start":{"row":199,"column":83},"end":{"row":199,"column":84},"action":"insert","lines":["E"]},{"start":{"row":199,"column":84},"end":{"row":199,"column":85},"action":"insert","lines":["L"]},{"start":{"row":199,"column":85},"end":{"row":199,"column":86},"action":"insert","lines":["E"]}],[{"start":{"row":199,"column":82},"end":{"row":199,"column":86},"action":"remove","lines":["SELE"],"id":236},{"start":{"row":199,"column":82},"end":{"row":199,"column":88},"action":"insert","lines":["SELECT"]}],[{"start":{"row":199,"column":88},"end":{"row":199,"column":89},"action":"insert","lines":[" "],"id":237},{"start":{"row":199,"column":89},"end":{"row":199,"column":90},"action":"insert","lines":["M"]},{"start":{"row":199,"column":90},"end":{"row":199,"column":91},"action":"insert","lines":["A"]},{"start":{"row":199,"column":91},"end":{"row":199,"column":92},"action":"insert","lines":["X"]}],[{"start":{"row":199,"column":92},"end":{"row":199,"column":94},"action":"insert","lines":["()"],"id":238}],[{"start":{"row":199,"column":93},"end":{"row":199,"column":94},"action":"insert","lines":["'"],"id":239},{"start":{"row":199,"column":94},"end":{"row":199,"column":95},"action":"insert","lines":["'"]}],[{"start":{"row":199,"column":94},"end":{"row":199,"column":95},"action":"insert","lines":["C"],"id":240},{"start":{"row":199,"column":95},"end":{"row":199,"column":96},"action":"insert","lines":["R"]},{"start":{"row":199,"column":96},"end":{"row":199,"column":97},"action":"insert","lines":["E"]}],[{"start":{"row":199,"column":96},"end":{"row":199,"column":97},"action":"remove","lines":["E"],"id":241},{"start":{"row":199,"column":95},"end":{"row":199,"column":96},"action":"remove","lines":["R"]},{"start":{"row":199,"column":94},"end":{"row":199,"column":95},"action":"remove","lines":["C"]}],[{"start":{"row":199,"column":94},"end":{"row":199,"column":95},"action":"insert","lines":["c"],"id":242}],[{"start":{"row":199,"column":94},"end":{"row":199,"column":95},"action":"remove","lines":["c"],"id":243},{"start":{"row":199,"column":94},"end":{"row":199,"column":106},"action":"insert","lines":["created_date"]}],[{"start":{"row":199,"column":108},"end":{"row":199,"column":109},"action":"insert","lines":[" "],"id":244},{"start":{"row":199,"column":109},"end":{"row":199,"column":110},"action":"insert","lines":["F"]},{"start":{"row":199,"column":110},"end":{"row":199,"column":111},"action":"insert","lines":["R"]},{"start":{"row":199,"column":111},"end":{"row":199,"column":112},"action":"insert","lines":["O"]},{"start":{"row":199,"column":112},"end":{"row":199,"column":113},"action":"insert","lines":["M"]}],[{"start":{"row":199,"column":113},"end":{"row":199,"column":114},"action":"insert","lines":[" "],"id":245}],[{"start":{"row":199,"column":114},"end":{"row":199,"column":115},"action":"insert","lines":["i"],"id":246},{"start":{"row":199,"column":115},"end":{"row":199,"column":116},"action":"insert","lines":["t"]},{"start":{"row":199,"column":116},"end":{"row":199,"column":117},"action":"insert","lines":["e"]},{"start":{"row":199,"column":117},"end":{"row":199,"column":118},"action":"insert","lines":["m"]}],[{"start":{"row":200,"column":40},"end":{"row":201,"column":0},"action":"insert","lines":["",""],"id":267},{"start":{"row":201,"column":0},"end":{"row":201,"column":16},"action":"insert","lines":["                "]}],[{"start":{"row":201,"column":16},"end":{"row":205,"column":5},"action":"insert","lines":["$stmt=$pdo->query($sql);","    ","    while($row=$stmt->fetch()){","        $data_array[] = $row;","    }"],"id":268}],[{"start":{"row":201,"column":39},"end":{"row":201,"column":40},"action":"remove","lines":[";"],"id":269},{"start":{"row":201,"column":38},"end":{"row":201,"column":39},"action":"remove","lines":[")"]},{"start":{"row":201,"column":37},"end":{"row":201,"column":38},"action":"remove","lines":["l"]},{"start":{"row":201,"column":36},"end":{"row":201,"column":37},"action":"remove","lines":["q"]},{"start":{"row":201,"column":35},"end":{"row":201,"column":36},"action":"remove","lines":["s"]},{"start":{"row":201,"column":34},"end":{"row":201,"column":35},"action":"remove","lines":["$"]},{"start":{"row":201,"column":33},"end":{"row":201,"column":34},"action":"remove","lines":["("]},{"start":{"row":201,"column":32},"end":{"row":201,"column":33},"action":"remove","lines":["y"]},{"start":{"row":201,"column":31},"end":{"row":201,"column":32},"action":"remove","lines":["r"]},{"start":{"row":201,"column":30},"end":{"row":201,"column":31},"action":"remove","lines":["e"]},{"start":{"row":201,"column":29},"end":{"row":201,"column":30},"action":"remove","lines":["u"]},{"start":{"row":201,"column":28},"end":{"row":201,"column":29},"action":"remove","lines":["q"]},{"start":{"row":201,"column":27},"end":{"row":201,"column":28},"action":"remove","lines":[">"]},{"start":{"row":201,"column":26},"end":{"row":201,"column":27},"action":"remove","lines":["-"]},{"start":{"row":201,"column":25},"end":{"row":201,"column":26},"action":"remove","lines":["o"]},{"start":{"row":201,"column":24},"end":{"row":201,"column":25},"action":"remove","lines":["d"]},{"start":{"row":201,"column":23},"end":{"row":201,"column":24},"action":"remove","lines":["p"]},{"start":{"row":201,"column":22},"end":{"row":201,"column":23},"action":"remove","lines":["$"]},{"start":{"row":201,"column":21},"end":{"row":201,"column":22},"action":"remove","lines":["="]}],[{"start":{"row":201,"column":20},"end":{"row":201,"column":21},"action":"remove","lines":["t"],"id":270},{"start":{"row":201,"column":19},"end":{"row":201,"column":20},"action":"remove","lines":["m"]},{"start":{"row":201,"column":18},"end":{"row":201,"column":19},"action":"remove","lines":["t"]},{"start":{"row":201,"column":17},"end":{"row":201,"column":18},"action":"remove","lines":["s"]},{"start":{"row":201,"column":16},"end":{"row":201,"column":17},"action":"remove","lines":["$"]},{"start":{"row":201,"column":12},"end":{"row":201,"column":16},"action":"remove","lines":["    "]},{"start":{"row":201,"column":8},"end":{"row":201,"column":12},"action":"remove","lines":["    "]},{"start":{"row":201,"column":4},"end":{"row":201,"column":8},"action":"remove","lines":["    "]}],[{"start":{"row":201,"column":0},"end":{"row":201,"column":4},"action":"remove","lines":["    "],"id":271},{"start":{"row":200,"column":40},"end":{"row":201,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":202,"column":4},"end":{"row":202,"column":8},"action":"insert","lines":["    "],"id":272}],[{"start":{"row":202,"column":8},"end":{"row":202,"column":12},"action":"insert","lines":["    "],"id":273}],[{"start":{"row":202,"column":12},"end":{"row":202,"column":16},"action":"insert","lines":["    "],"id":274}],[{"start":{"row":203,"column":8},"end":{"row":203,"column":12},"action":"insert","lines":["    "],"id":275}],[{"start":{"row":203,"column":12},"end":{"row":203,"column":16},"action":"insert","lines":["    "],"id":276}],[{"start":{"row":203,"column":16},"end":{"row":203,"column":20},"action":"insert","lines":["    "],"id":277}],[{"start":{"row":204,"column":4},"end":{"row":204,"column":8},"action":"insert","lines":["    "],"id":278}],[{"start":{"row":204,"column":8},"end":{"row":204,"column":12},"action":"insert","lines":["    "],"id":279}],[{"start":{"row":204,"column":12},"end":{"row":204,"column":16},"action":"insert","lines":["    "],"id":280}],[{"start":{"row":204,"column":17},"end":{"row":205,"column":0},"action":"insert","lines":["",""],"id":281},{"start":{"row":205,"column":0},"end":{"row":205,"column":16},"action":"insert","lines":["                "]},{"start":{"row":205,"column":16},"end":{"row":206,"column":0},"action":"insert","lines":["",""]},{"start":{"row":206,"column":0},"end":{"row":206,"column":16},"action":"insert","lines":["                "]}],[{"start":{"row":206,"column":16},"end":{"row":206,"column":17},"action":"insert","lines":["$"],"id":282},{"start":{"row":206,"column":17},"end":{"row":206,"column":18},"action":"insert","lines":["i"]}],[{"start":{"row":206,"column":18},"end":{"row":206,"column":19},"action":"insert","lines":["t"],"id":283},{"start":{"row":206,"column":19},"end":{"row":206,"column":20},"action":"insert","lines":["e"]},{"start":{"row":206,"column":20},"end":{"row":206,"column":21},"action":"insert","lines":["m"]},{"start":{"row":206,"column":21},"end":{"row":206,"column":22},"action":"insert","lines":["_"]},{"start":{"row":206,"column":22},"end":{"row":206,"column":23},"action":"insert","lines":["i"]},{"start":{"row":206,"column":23},"end":{"row":206,"column":24},"action":"insert","lines":["d"]}],[{"start":{"row":206,"column":24},"end":{"row":206,"column":25},"action":"insert","lines":[" "],"id":284},{"start":{"row":206,"column":25},"end":{"row":206,"column":26},"action":"insert","lines":["="]}],[{"start":{"row":206,"column":26},"end":{"row":206,"column":27},"action":"insert","lines":[" "],"id":285}],[{"start":{"row":206,"column":27},"end":{"row":206,"column":28},"action":"insert","lines":["$"],"id":286},{"start":{"row":206,"column":28},"end":{"row":206,"column":29},"action":"insert","lines":["d"]},{"start":{"row":206,"column":29},"end":{"row":206,"column":30},"action":"insert","lines":["a"]},{"start":{"row":206,"column":30},"end":{"row":206,"column":31},"action":"insert","lines":["t"]},{"start":{"row":206,"column":31},"end":{"row":206,"column":32},"action":"insert","lines":["a"]}],[{"start":{"row":206,"column":27},"end":{"row":206,"column":32},"action":"remove","lines":["$data"],"id":287},{"start":{"row":206,"column":27},"end":{"row":206,"column":38},"action":"insert","lines":["$data_array"]}],[{"start":{"row":206,"column":38},"end":{"row":206,"column":40},"action":"insert","lines":["[]"],"id":288}],[{"start":{"row":206,"column":39},"end":{"row":206,"column":41},"action":"insert","lines":["''"],"id":289}],[{"start":{"row":206,"column":40},"end":{"row":206,"column":41},"action":"insert","lines":["i"],"id":290},{"start":{"row":206,"column":41},"end":{"row":206,"column":42},"action":"insert","lines":["d"]}],[{"start":{"row":206,"column":44},"end":{"row":206,"column":45},"action":"insert","lines":[";"],"id":291}],[{"start":{"row":215,"column":42},"end":{"row":216,"column":0},"action":"insert","lines":["",""],"id":292},{"start":{"row":216,"column":0},"end":{"row":216,"column":16},"action":"insert","lines":["                "]}],[{"start":{"row":216,"column":16},"end":{"row":216,"column":42},"action":"insert","lines":["$stmt->bindValue(3,$date);"],"id":293}],[{"start":{"row":216,"column":33},"end":{"row":216,"column":34},"action":"remove","lines":["3"],"id":294}],[{"start":{"row":216,"column":33},"end":{"row":216,"column":34},"action":"insert","lines":["4"],"id":295}],[{"start":{"row":216,"column":39},"end":{"row":216,"column":40},"action":"remove","lines":["e"],"id":296},{"start":{"row":216,"column":38},"end":{"row":216,"column":39},"action":"remove","lines":["t"]},{"start":{"row":216,"column":37},"end":{"row":216,"column":38},"action":"remove","lines":["a"]},{"start":{"row":216,"column":36},"end":{"row":216,"column":37},"action":"remove","lines":["d"]}],[{"start":{"row":216,"column":36},"end":{"row":216,"column":37},"action":"insert","lines":["i"],"id":297},{"start":{"row":216,"column":37},"end":{"row":216,"column":38},"action":"insert","lines":["t"]},{"start":{"row":216,"column":38},"end":{"row":216,"column":39},"action":"insert","lines":["e"]},{"start":{"row":216,"column":39},"end":{"row":216,"column":40},"action":"insert","lines":["m"]}],[{"start":{"row":216,"column":35},"end":{"row":216,"column":40},"action":"remove","lines":["$item"],"id":298},{"start":{"row":216,"column":35},"end":{"row":216,"column":43},"action":"insert","lines":["$item_id"]}],[{"start":{"row":329,"column":154},"end":{"row":329,"column":155},"action":"insert","lines":["_"],"id":299}],[{"start":{"row":197,"column":16},"end":{"row":197,"column":32},"action":"remove","lines":["$data_array =[];"],"id":300}],[{"start":{"row":172,"column":8},"end":{"row":172,"column":24},"action":"insert","lines":["$data_array =[];"],"id":301}],[{"start":{"row":199,"column":118},"end":{"row":199,"column":119},"action":"insert","lines":["_"],"id":302},{"start":{"row":199,"column":119},"end":{"row":199,"column":120},"action":"insert","lines":["i"]},{"start":{"row":199,"column":120},"end":{"row":199,"column":121},"action":"insert","lines":["n"]},{"start":{"row":199,"column":121},"end":{"row":199,"column":122},"action":"insert","lines":["f"]},{"start":{"row":199,"column":122},"end":{"row":199,"column":123},"action":"insert","lines":["o"]}],[{"start":{"row":199,"column":114},"end":{"row":199,"column":123},"action":"remove","lines":["item_info"],"id":303},{"start":{"row":199,"column":114},"end":{"row":199,"column":129},"action":"insert","lines":["item_info_table"]}],[{"start":{"row":199,"column":35},"end":{"row":199,"column":36},"action":"remove","lines":["_"],"id":304},{"start":{"row":199,"column":34},"end":{"row":199,"column":35},"action":"remove","lines":["m"]},{"start":{"row":199,"column":33},"end":{"row":199,"column":34},"action":"remove","lines":["e"]},{"start":{"row":199,"column":32},"end":{"row":199,"column":33},"action":"remove","lines":["t"]},{"start":{"row":199,"column":31},"end":{"row":199,"column":32},"action":"remove","lines":["i"]}],[{"start":{"row":205,"column":16},"end":{"row":205,"column":17},"action":"insert","lines":["v"],"id":305},{"start":{"row":205,"column":17},"end":{"row":205,"column":18},"action":"insert","lines":["a"]}],[{"start":{"row":205,"column":16},"end":{"row":205,"column":18},"action":"remove","lines":["va"],"id":306},{"start":{"row":205,"column":16},"end":{"row":205,"column":24},"action":"insert","lines":["var_dump"]}],[{"start":{"row":205,"column":24},"end":{"row":205,"column":26},"action":"insert","lines":["()"],"id":307}],[{"start":{"row":205,"column":25},"end":{"row":205,"column":26},"action":"insert","lines":["$"],"id":308},{"start":{"row":205,"column":26},"end":{"row":205,"column":27},"action":"insert","lines":["d"]},{"start":{"row":205,"column":27},"end":{"row":205,"column":28},"action":"insert","lines":["a"]}],[{"start":{"row":205,"column":25},"end":{"row":205,"column":28},"action":"remove","lines":["$da"],"id":309},{"start":{"row":205,"column":25},"end":{"row":205,"column":36},"action":"insert","lines":["$data_array"]}],[{"start":{"row":205,"column":37},"end":{"row":205,"column":38},"action":"insert","lines":[";"],"id":310}],[{"start":{"row":205,"column":37},"end":{"row":205,"column":38},"action":"remove","lines":[";"],"id":311},{"start":{"row":205,"column":36},"end":{"row":205,"column":37},"action":"remove","lines":[")"]},{"start":{"row":205,"column":35},"end":{"row":205,"column":36},"action":"remove","lines":["y"]},{"start":{"row":205,"column":34},"end":{"row":205,"column":35},"action":"remove","lines":["a"]},{"start":{"row":205,"column":33},"end":{"row":205,"column":34},"action":"remove","lines":["r"]},{"start":{"row":205,"column":32},"end":{"row":205,"column":33},"action":"remove","lines":["r"]},{"start":{"row":205,"column":31},"end":{"row":205,"column":32},"action":"remove","lines":["a"]},{"start":{"row":205,"column":30},"end":{"row":205,"column":31},"action":"remove","lines":["_"]},{"start":{"row":205,"column":29},"end":{"row":205,"column":30},"action":"remove","lines":["a"]},{"start":{"row":205,"column":28},"end":{"row":205,"column":29},"action":"remove","lines":["t"]},{"start":{"row":205,"column":27},"end":{"row":205,"column":28},"action":"remove","lines":["a"]},{"start":{"row":205,"column":26},"end":{"row":205,"column":27},"action":"remove","lines":["d"]},{"start":{"row":205,"column":25},"end":{"row":205,"column":26},"action":"remove","lines":["$"]},{"start":{"row":205,"column":24},"end":{"row":205,"column":25},"action":"remove","lines":["("]},{"start":{"row":205,"column":23},"end":{"row":205,"column":24},"action":"remove","lines":["p"]},{"start":{"row":205,"column":22},"end":{"row":205,"column":23},"action":"remove","lines":["m"]},{"start":{"row":205,"column":21},"end":{"row":205,"column":22},"action":"remove","lines":["u"]},{"start":{"row":205,"column":20},"end":{"row":205,"column":21},"action":"remove","lines":["d"]},{"start":{"row":205,"column":19},"end":{"row":205,"column":20},"action":"remove","lines":["_"]},{"start":{"row":205,"column":18},"end":{"row":205,"column":19},"action":"remove","lines":["r"]}],[{"start":{"row":205,"column":17},"end":{"row":205,"column":18},"action":"remove","lines":["a"],"id":312},{"start":{"row":205,"column":16},"end":{"row":205,"column":17},"action":"remove","lines":["v"]}],[{"start":{"row":200,"column":16},"end":{"row":201,"column":0},"action":"insert","lines":["",""],"id":313},{"start":{"row":201,"column":0},"end":{"row":201,"column":16},"action":"insert","lines":["                "]}],[{"start":{"row":200,"column":16},"end":{"row":200,"column":17},"action":"insert","lines":["v"],"id":314},{"start":{"row":200,"column":17},"end":{"row":200,"column":18},"action":"insert","lines":["a"]},{"start":{"row":200,"column":18},"end":{"row":200,"column":19},"action":"insert","lines":["7"]}],[{"start":{"row":200,"column":18},"end":{"row":200,"column":19},"action":"remove","lines":["7"],"id":315}],[{"start":{"row":200,"column":18},"end":{"row":200,"column":19},"action":"insert","lines":["r"],"id":316}],[{"start":{"row":200,"column":16},"end":{"row":200,"column":19},"action":"remove","lines":["var"],"id":317},{"start":{"row":200,"column":16},"end":{"row":200,"column":24},"action":"insert","lines":["var_dump"]}],[{"start":{"row":200,"column":24},"end":{"row":200,"column":26},"action":"insert","lines":["()"],"id":318}],[{"start":{"row":200,"column":25},"end":{"row":200,"column":26},"action":"insert","lines":["$"],"id":319},{"start":{"row":200,"column":26},"end":{"row":200,"column":27},"action":"insert","lines":["s"]},{"start":{"row":200,"column":27},"end":{"row":200,"column":28},"action":"insert","lines":["q"]},{"start":{"row":200,"column":28},"end":{"row":200,"column":29},"action":"insert","lines":["l"]}],[{"start":{"row":200,"column":30},"end":{"row":200,"column":31},"action":"insert","lines":[";"],"id":320}],[{"start":{"row":199,"column":101},"end":{"row":199,"column":102},"action":"remove","lines":["'"],"id":321}],[{"start":{"row":199,"column":88},"end":{"row":199,"column":89},"action":"remove","lines":["'"],"id":322}],[{"start":{"row":206,"column":16},"end":{"row":206,"column":17},"action":"insert","lines":["v"],"id":323},{"start":{"row":206,"column":17},"end":{"row":206,"column":18},"action":"insert","lines":["a"]}],[{"start":{"row":206,"column":16},"end":{"row":206,"column":18},"action":"remove","lines":["va"],"id":324},{"start":{"row":206,"column":16},"end":{"row":206,"column":24},"action":"insert","lines":["var_dump"]}],[{"start":{"row":206,"column":24},"end":{"row":206,"column":26},"action":"insert","lines":["()"],"id":325}],[{"start":{"row":206,"column":25},"end":{"row":206,"column":38},"action":"insert","lines":["$data_array[]"],"id":326}],[{"start":{"row":206,"column":39},"end":{"row":206,"column":40},"action":"insert","lines":["l"],"id":327}],[{"start":{"row":206,"column":39},"end":{"row":206,"column":40},"action":"remove","lines":["l"],"id":328}],[{"start":{"row":206,"column":39},"end":{"row":206,"column":40},"action":"insert","lines":[";"],"id":329}],[{"start":{"row":206,"column":37},"end":{"row":206,"column":38},"action":"remove","lines":["]"],"id":330},{"start":{"row":206,"column":36},"end":{"row":206,"column":37},"action":"remove","lines":["["]}],[{"start":{"row":200,"column":30},"end":{"row":200,"column":31},"action":"remove","lines":[";"],"id":331},{"start":{"row":200,"column":29},"end":{"row":200,"column":30},"action":"remove","lines":[")"]},{"start":{"row":200,"column":28},"end":{"row":200,"column":29},"action":"remove","lines":["l"]},{"start":{"row":200,"column":27},"end":{"row":200,"column":28},"action":"remove","lines":["q"]},{"start":{"row":200,"column":26},"end":{"row":200,"column":27},"action":"remove","lines":["s"]},{"start":{"row":200,"column":25},"end":{"row":200,"column":26},"action":"remove","lines":["$"]},{"start":{"row":200,"column":24},"end":{"row":200,"column":25},"action":"remove","lines":["("]},{"start":{"row":200,"column":23},"end":{"row":200,"column":24},"action":"remove","lines":["p"]},{"start":{"row":200,"column":22},"end":{"row":200,"column":23},"action":"remove","lines":["m"]},{"start":{"row":200,"column":21},"end":{"row":200,"column":22},"action":"remove","lines":["u"]},{"start":{"row":200,"column":20},"end":{"row":200,"column":21},"action":"remove","lines":["d"]},{"start":{"row":200,"column":19},"end":{"row":200,"column":20},"action":"remove","lines":["_"]},{"start":{"row":200,"column":18},"end":{"row":200,"column":19},"action":"remove","lines":["r"]},{"start":{"row":200,"column":17},"end":{"row":200,"column":18},"action":"remove","lines":["a"]},{"start":{"row":200,"column":16},"end":{"row":200,"column":17},"action":"remove","lines":["v"]},{"start":{"row":200,"column":12},"end":{"row":200,"column":16},"action":"remove","lines":["    "]}],[{"start":{"row":200,"column":8},"end":{"row":200,"column":12},"action":"remove","lines":["    "],"id":332}],[{"start":{"row":207,"column":41},"end":{"row":207,"column":42},"action":"remove","lines":["d"],"id":333},{"start":{"row":207,"column":40},"end":{"row":207,"column":41},"action":"remove","lines":["i"]}],[{"start":{"row":207,"column":40},"end":{"row":207,"column":41},"action":"insert","lines":["0"],"id":334}],[{"start":{"row":207,"column":41},"end":{"row":207,"column":42},"action":"remove","lines":["'"],"id":335}],[{"start":{"row":207,"column":39},"end":{"row":207,"column":40},"action":"remove","lines":["'"],"id":336}],[{"start":{"row":207,"column":41},"end":{"row":207,"column":43},"action":"insert","lines":["[]"],"id":337}],[{"start":{"row":207,"column":42},"end":{"row":207,"column":44},"action":"insert","lines":["''"],"id":338}],[{"start":{"row":207,"column":43},"end":{"row":207,"column":44},"action":"insert","lines":["i"],"id":339},{"start":{"row":207,"column":44},"end":{"row":207,"column":45},"action":"insert","lines":["d"]}],[{"start":{"row":208,"column":16},"end":{"row":208,"column":17},"action":"insert","lines":["v"],"id":340},{"start":{"row":208,"column":17},"end":{"row":208,"column":18},"action":"insert","lines":["a"]},{"start":{"row":208,"column":18},"end":{"row":208,"column":19},"action":"insert","lines":["r"]}],[{"start":{"row":208,"column":16},"end":{"row":208,"column":19},"action":"remove","lines":["var"],"id":341},{"start":{"row":208,"column":16},"end":{"row":208,"column":24},"action":"insert","lines":["var_dump"]}],[{"start":{"row":208,"column":24},"end":{"row":208,"column":26},"action":"insert","lines":["()"],"id":342}],[{"start":{"row":208,"column":25},"end":{"row":208,"column":26},"action":"insert","lines":["$"],"id":343},{"start":{"row":208,"column":26},"end":{"row":208,"column":27},"action":"insert","lines":["i"]},{"start":{"row":208,"column":27},"end":{"row":208,"column":28},"action":"insert","lines":["t"]},{"start":{"row":208,"column":28},"end":{"row":208,"column":29},"action":"insert","lines":["e"]},{"start":{"row":208,"column":29},"end":{"row":208,"column":30},"action":"insert","lines":["m"]}],[{"start":{"row":208,"column":25},"end":{"row":208,"column":30},"action":"remove","lines":["$item"],"id":344},{"start":{"row":208,"column":25},"end":{"row":208,"column":33},"action":"insert","lines":["$item_id"]}],[{"start":{"row":208,"column":34},"end":{"row":208,"column":35},"action":"insert","lines":[";"],"id":345}],[{"start":{"row":208,"column":35},"end":{"row":209,"column":0},"action":"insert","lines":["",""],"id":346},{"start":{"row":209,"column":0},"end":{"row":209,"column":16},"action":"insert","lines":["                "]}],[{"start":{"row":209,"column":16},"end":{"row":210,"column":16},"action":"remove","lines":["","                "],"id":347}],[{"start":{"row":397,"column":26},"end":{"row":397,"column":27},"action":"remove","lines":[";"],"id":348},{"start":{"row":397,"column":25},"end":{"row":397,"column":26},"action":"remove","lines":[")"]},{"start":{"row":397,"column":24},"end":{"row":397,"column":25},"action":"remove","lines":["l"]},{"start":{"row":397,"column":23},"end":{"row":397,"column":24},"action":"remove","lines":["q"]},{"start":{"row":397,"column":22},"end":{"row":397,"column":23},"action":"remove","lines":["s"]},{"start":{"row":397,"column":21},"end":{"row":397,"column":22},"action":"remove","lines":["$"]},{"start":{"row":397,"column":20},"end":{"row":397,"column":21},"action":"remove","lines":["("]},{"start":{"row":397,"column":19},"end":{"row":397,"column":20},"action":"remove","lines":["p"]},{"start":{"row":397,"column":18},"end":{"row":397,"column":19},"action":"remove","lines":["m"]},{"start":{"row":397,"column":17},"end":{"row":397,"column":18},"action":"remove","lines":["u"]},{"start":{"row":397,"column":16},"end":{"row":397,"column":17},"action":"remove","lines":["d"]},{"start":{"row":397,"column":15},"end":{"row":397,"column":16},"action":"remove","lines":["_"]},{"start":{"row":397,"column":14},"end":{"row":397,"column":15},"action":"remove","lines":["r"]},{"start":{"row":397,"column":13},"end":{"row":397,"column":14},"action":"remove","lines":["a"]},{"start":{"row":397,"column":12},"end":{"row":397,"column":13},"action":"remove","lines":["v"]},{"start":{"row":397,"column":8},"end":{"row":397,"column":12},"action":"remove","lines":["    "]},{"start":{"row":397,"column":4},"end":{"row":397,"column":8},"action":"remove","lines":["    "]},{"start":{"row":397,"column":0},"end":{"row":397,"column":4},"action":"remove","lines":["    "]}],[{"start":{"row":396,"column":63},"end":{"row":397,"column":0},"action":"remove","lines":["",""],"id":349}]]},"ace":{"folds":[],"scrolltop":4527.5,"scrollleft":0,"selection":{"start":{"row":396,"column":63},"end":{"row":396,"column":63},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":54,"state":"php-start","mode":"ace/mode/php"}},"timestamp":1639982905709}