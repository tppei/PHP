{"changed":true,"filter":false,"title":"model.php","tooltip":"/ECinclude/model.php","value":"<?php\n\n// ぺージ共通関数\n/**\n* 特殊文字をHTMLエンティティに変換する\n* @param str  $str 変換前文字\n* @return str 変換後文字\n*/\nfunction entity_str($str) {\n    return htmlspecialchars($str, ENT_QUOTES, 'utf-8');\n}\n\n/**\n* クエリを実行しその結果を配列で取得する\n*\n* @param obj  $link DBハンドル\n* @param str  $sql SQL文\n* @return array 結果配列データ\n*/\nfunction get_as_array($pdo,$sql) {\n \n    // 返却用配列\n    global $data;\n    \n    // 配列を空にする\n    $data = [];\n \n    // クエリを実行する\n    $stmt=$pdo->query($sql);\n \n    while($row=$stmt->fetch()){\n        $data[] = $row;\n    }\n    \n    return $data;\n \n}\n/**\n* リクエストメソッドを取得\n* @return str GET/POST/PUTなど\n*/\nfunction get_request_method() {\n   return $_SERVER['REQUEST_METHOD'];\n}\n/**\n* POSTデータを取得\n* @param str $key 配列キー\n* @return str POST値\n*/\nfunction get_post_data($key) {\n   $str = '';\n   if (isset($_POST[$key]) === TRUE) {\n       $str = $_POST[$key];\n   }\n   return $str;\n}\n\n// 空白チェック関数\nfunction input_blank_check($subject){\n    global $input_err;\n    if($_SERVER['REQUEST_METHOD'] === 'POST'){\n        if(isset($_POST[$subject])){\n            if($_POST[$subject] === \"\"){\n                if($subject === 'new_name'){\n                    $input_err[] = \"名前を入力してください<br>\";\n                }else if($subject === 'new_price'){\n                    $input_err[] = \"値段を入力してください<br>\";\n                }else if($subject === 'new_stock'){\n                    $input_err[] = \"個数を入力してください<br>\";\n                }else if($subject === 'user_name'){\n                    $input_err[] = \"ユーザー名を入力してください<br>\";\n                }else if($subject === 'passwd'){\n                    $input_err[] = \"パスワードを入力してください<br>\";\n                }\n            }\n        }\n    }\n    return $input_err;\n}\n \n// 文字入力半角数字正規表現チェック関数\nfunction input_charnumcheck($subject){\n    if ($_SERVER['REQUEST_METHOD'] === 'POST'){\n        global $regexp_price;\n        global $regexp_file;\n        global $input_err;\n        if(isset($_POST[$subject])){\n            // 空白だった場合に以下のエラーを表示させない\n            if($_POST[$subject] !== \"\"){\n                if(!preg_match($regexp_price,$_POST[$subject])){\n                    if($subject === 'new_price'){\n                        //   値段が半角数字ではない\n                        $input_err[] = \"値段は半角数字を入力してください<br>\";\n                    }else if($subject === 'new_stock' || $subject === 'select_amount' || $subject === 'updated_stock' || $subject === 'update_stock'){\n                        //   個数が半角数字ではない\n                        $input_err[] = \"個数は半角数字を入力してください<br>\";\n                    }\n                }else if($subject === 'new_price' && $_POST[$subject] > 10000){\n                    //   値段が半角で１万より上\n                    $input_err[] = \"値段は1万円以下にして下さい<br>\";\n                }else{\n                       \n                }\n            }\n        }\n        return $input_err;\n    }\n}\n\n// 文字入力半角英数字6字以上正規表現チェック関数\nfunction input_charcheck($subject){\n    if ($_SERVER['REQUEST_METHOD'] === 'POST'){\n        global $regexp_user;\n        global $input_err;\n        if(isset($_POST[$subject])){\n             // 空白だった場合に以下のエラーを表示させない\n            if($_POST[$subject] !== \"\"){\n                if(!preg_match($regexp_user,$_POST[$subject])){\n                    if($subject === 'user_name'){\n                        $input_err[] = \"ユーザー名は半角英数字6文字以上で入力してください<br>\";\n                    }else if($subject === 'passwd'){\n                        $input_err[] = \"パスワードは半角英数字6文字以上で入力してください<br>\";\n                    }\n                }else{\n                    \n                }\n            }\n        }\n        return $input_err;\n    }\n}\n\n// 画像ファイルエラー関数\nfunction file_check(){\n    global $input_err;\n    global $regexp_file;\n    if ($_SERVER['REQUEST_METHOD'] === 'POST'){\n        if(isset($_FILES['new_img']['name'])){\n            if(empty($_FILES['new_img']['name'])){\n                //   ファイル名が空白\n                $input_err[] = \"ファイルを選択してください<br>\";\n            }else{\n                // ファイル形式が異なる\n                if(!preg_match($regexp_file,$_FILES['new_img']['name'])){\n                    $input_err[] = \"ファイル形式が異なります。画像ファイルはJPEG又はPNGのみ利用可能です。<br>\";\n                }\n            }\n        }\n        return  $input_err;\n    }\n}       \n               \n// エラー表示関数\nfunction err_display($input_err){\n    foreach($input_err as $go){\n        print $go;\n    }\n} \n\n// db接続関数\nfunction get_db_connect() {\n            $username = 'codecamp49497';\n            $passwd = 'codecamp49497';\n        try{\n            // pdoによるMYSQLへの接続\n            $pdo = new PDO('mysql:host=localhost;dbname=codecamp49497;charset=utf8;',$username,$passwd);\n            //例外をスロ-\n            $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);\n            $pdo->setAttribute(PDO::ATTR_EMULATE_PREPARES, false);\n            \n        }catch(PDOException $e){\n            //エラー情報の表示\n            //エラーコード取得\n            $code=$e->getCode();\n            //エラーメッセージ取得\n            $message=$e->getMessage();\n            print '接続失敗しました';\n            print '<br>';\n            print(\"{$code}/{$message}<brS>\");\n            //プログラム終了\n            die();\n        }\n            return $pdo;\n}\n\n// 管理者ブラウザに表示する表の作成\n function table_display($pdo){\n    $data_array =[];\n    // 表作成のためのカラム取得\n    $sql = \"SELECT item_info_table.id,name,img,price,stock,status FROM item_info_table JOIN item_stock_table ON item_info_table.id = item_stock_table.item_id\";\n    $stmt=$pdo->query($sql);\n    \n    while($row=$stmt->fetch()){\n        $data_array[] = $row;\n    }\n    \n    return $data_array;\n }\n \n function user_table($pdo,$sql){\n     $data =[];\n     $stmt=$pdo->query($sql);\n     while($row=$stmt->fetch()){\n        $data[] = $row;\n    }\n    \n    return $data;\n }\n \n// 以下ec_itemtegisterで使用する関数\n// 商品情報追加関数           \nfunction detail_insert($pdo,$input_err){\n        // 変数初期化\n        global $date;\n        $err_msg = [];\n        $data_array =[];\n        $new_name = \"\";\n        $new_price = 0;\n        $filename = \"\";\n        $new_status =0;\n        $new_stock = 0;\n        $uploader = \"./image/\";\n        \n        if($_SERVER['REQUEST_METHOD'] === 'POST'){\n            // 商品名、値段、画像、ステータス、数の情報をpostで受け取った場合\n            if(isset($_POST['new_name']) && isset($_POST['new_price']) && isset($_POST['new_status']) && isset($_POST['new_stock'])){\n                // 入力でエラーがない場合\n                if(count($input_err) === 0){\n                    // 変数に取得情報を代入\n                    $new_name = get_post_data('new_name');\n                    $new_price = get_post_data('new_price');\n                    $new_status = get_post_data('new_status');\n                    $new_stock = get_post_data('new_stock');\n                    \n                    // 画像ファイルの保存\n                    if(isset($_FILES['new_img']['name'])){\n                    //  保存先のパスとブラウザ上に一時保存された画像名を結合\n                      $upload = $uploader . basename($_FILES['new_img']['name']);\n                    //   var_dump($upload);\n                    \n                    //   アップロードされた画像をファイルに保存\n                      if(move_uploaded_file($_FILES['new_img']['tmp_name'],$upload) !== TRUE){\n                          $err_msg[] = '保存失敗';\n                      };\n                       \n                    //   変数に画像名を代入\n                      $filename = basename($_FILES['new_img']['name']);\n                    }\n                    \n                    \n                        \n                        //   アイテム表に行追加\n                        $query_detail = \"INSERT INTO item_info_table (name,price,img,status,created_date,updated_date) VALUES(?,?,?,?,?,?)\";\n                        $stmt=$pdo->prepare($query_detail);\n                        \n                        \n                        // バインド　以下sqlインジェクション対策\n                        $stmt->bindValue(1,$new_name);\n                        $stmt->bindValue(2,$new_price);\n                        $stmt->bindValue(3,$filename);\n                        $stmt->bindValue(4,$new_status);\n                        $stmt->bindValue(5,$date);\n                        $stmt->bindValue(6,$date);\n                        $stmt->execute();\n                        \n                        \n                        // 表作成のためのカラム取得\n                        $sql = \"SELECT id FROM item_info_table WHERE created_date = (SELECT MAX(created_date) FROM item_info_table)\";\n                \n                        $stmt=$pdo->query($sql);\n            \n                        while($row=$stmt->fetch()){\n                            $data_array[] = $row;\n                        }\n                        \n                        $item_id = $data_array[0]['id'];\n                        \n                        //   在庫表に行追加\n                        $query_stock = \"INSERT INTO item_stock_table (stock,created_date,updated_date,item_id) VALUES(?,?,?,?)\";\n                        $stmt=$pdo->prepare($query_stock);\n                        \n                        // バインド　以下sqlインジェクション対策\n                        $stmt->bindValue(1,$new_stock);\n                        $stmt->bindValue(2,$date);\n                        $stmt->bindValue(3,$date);\n                        $stmt->bindValue(4,$item_id);\n                        $stmt->execute();\n                        \n                }else{\n                //   入力エラーある場合エラー内容を表示\n                       err_display($input_err);\n                }\n            }\n        }\n}\n\n//  在庫数変更関数\nfunction stock_change($pdo,$input_err){\n    global $date;\n    if ($_SERVER['REQUEST_METHOD'] === 'POST'){\n        // 在庫数変更\n        if(isset($_POST['update_stock']) && isset($_POST['id'])){\n            if(count($input_err) === 0){\n                // 在庫数変更をデータベースに保存 \n                \n                $update_stock = $_POST['update_stock'];\n                // 確認用\n                // var_dump($update_stock);\n                \n                $update_drinkid = $_POST['id'];\n                \n                // 在庫数変更クエリ\n                $query = \"UPDATE item_stock_table SET stock = $update_stock WHERE item_id = $update_drinkid\";\n                // 確認用\n                // return var_dump($query);\n                                \n                // クエリを実行します\n                $stmt=$pdo->query($query);\n                \n                $query = \"UPDATE item_stock_table SET updated_date = '$date' WHERE item_id = $update_drinkid\";\n                $stmt=$pdo->query($query);\n                \n                print \"在庫数変更完了\";\n        \n            }else{\n                err_display($input_err);\n            }\n        }\n    }\n}\n\n// ステータス変更関数\nfunction status_change($pdo){\n    global $date;\n    if ($_SERVER['REQUEST_METHOD'] === 'POST'){\n        // ステータス変更\n        if(isset($_POST[\"change_status\"])){\n            // 現在の公開ステータス\n            $prestatus = $_POST[\"change_status\"];\n            // var_dump($prestatus);            \n            // 現在のステータスが0ならば、変更後は１　そうでないなら変更後は0\n            if($prestatus === '0'){\n                $poststatus = '1';\n            }else{\n                $poststatus = '0';\n            }\n            \n            // id取得\n            $update_drinkid = $_POST['id'];\n\n            // ステータス変更クエリ\n            $status_query = \"UPDATE item_info_table SET status = '$poststatus' WHERE id = $update_drinkid\";\n            \n            // クエリを実行します\n            $stmt=$pdo->query($status_query);\n            \n            // updated_date更新クエリ\n            $update_date_query = \"UPDATE item_info_table SET updated_date = '$date'\";\n            \n            // クエリを実行\n            $stmt=$pdo->query($update_date_query);\n            \n            print \"ステータス変更完了\";\n        }\n    }\n}\n \n// 登録商品削除関数\nfunction delete_iteminfo($pdo){\n    if($_SERVER['REQUEST_METHOD'] === 'POST'){\n        if(isset($_POST['delete'])){\n            // id取得\n            $id = $_POST['id'];\n            \n            // 登録商品テーブル\n            $sql = \"DELETE FROM item_info_table WHERE id= $id\";\n            $stmt=$pdo->query($sql);\n            \n            print \"削除完了\";\n        }\n    \n    }\n    \n}\n\n// 以下ec_userregister内で使用する関数\n// 登録するユーザー名が既存かどうか調べる関数\nfunction check_same_user ($pdo){\n    global $data;\n    $register_err = [];\n    $username = '';\n    $username = get_post_data('user_name');\n    \n    $sql = \"SELECT * FROM user_info_table WHERE user_name = '$username' \";\n    $data = get_as_array($pdo,$sql);\n    if(!empty($data)){\n        $register_err[] = 'このユーザー名はすでに登録されているため、登録できません<br>';\n    }\n    \n    return $register_err;\n}\n\n// ユーザー登録関数\nfunction user_register($input_err,$register_err,$pdo){\n    global $date;\n    $new_user = '';\n    $new_pass = '';\n     \n     if($_SERVER['REQUEST_METHOD'] === 'POST'){\n        // 上記2つの関数()でエラーがない場合\n        if(count($input_err) === 0 && count($register_err) === 0){\n            try{\n                \n                $new_user = get_post_data('user_name');\n                $new_pass = get_post_data('passwd');\n                    \n                   \n                $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);\n                $pdo->setAttribute(PDO::ATTR_EMULATE_PREPARES, false);\n                    \n                // トランザクション開始\n                $pdo->beginTransaction();\n                    \n                //   user_info表に行追加\n                $query_detail = \"INSERT INTO user_info_table (user_name,password,created_date,updated_date) VALUES(?,?,?,?)\";\n                $stmt=$pdo->prepare($query_detail);\n                    \n                    \n                // バインド　以下sqlインジェクション対策\n                $stmt->bindValue(1,$new_user);\n                $stmt->bindValue(2,$new_pass);\n                $stmt->bindValue(3,$date);\n                $stmt->bindValue(4,$date);\n                \n                $stmt->execute();\n                    \n                    \n                //コミット\n                $pdo->commit();\n                    \n                print '登��完了しました';\n                \n                \n            }catch(PDOException $e){\n                if(isset($pdo)===true && $pdo->inTransaction()===true){\n                    //ロールバックする\n                    $pdo->rollBack();\n                }\n                 \n                //エラー情報の表示\n                //エラーコード取得\n                $code=$e->getCode();\n                 //エラーメッセージ取得\n                $message=$e->getMessage();\n                \n                print 'sql文の実行が失敗しました';\n                print '<br>';\n                print(\"{$code}/{$message}<brS>\");\n                //プログラム終了\n                die();\n            }\n        }else{\n            err_display($input_err);\n            foreach($register_err as $go){\n                print $go;\n            }\n        }\n    }\n}\n\n\n// 以下ec_cart.php内で使用する関数\n// カート商品追加関数\nfunction cart_adding ($pdo,$item_id,$user_id){\n    global $date;\n    $query = '';\n    $sql = '';\n    $add_sql = \"\";\n    $amount_select_sql = \"\";\n    $amount = 0;\n    $stock_get = \"\";\n    $stock = 0;\n    $data = \"\";\n    if(isset($_POST['additem_id'])){\n        // カートに追加する商品がすでにカート内にあるか確かめるクエリ\n        $sql = \"SELECT item_id FROM cart_table WHERE item_id = $item_id\";\n            // 上のクエリで取得できなかった場合\n            if(empty(get_as_array($pdo,$sql))){\n                   \n                    // カートテーブルに商品情報追加\n                    $query = \"INSERT INTO cart_table(user_id,item_id,amount,created_date,updated_date) VALUES(?,?,?,?,?)\";\n                    \n                    $stmt=$pdo->prepare($query);\n                    \n                    // バインド　以下sqlインジェクション対策\n                    $stmt->bindValue(1,$user_id);\n                    $stmt->bindValue(2,$item_id);\n                    $stmt->bindValue(3,1);\n                    $stmt->bindValue(4,$date);\n                    $stmt->bindValue(5,$date);\n                    $stmt->execute();\n                    print 'カートにいれました';\n            \n            // 上のクエリで取得できた場合\n            }else{ \n                 \n                    \n                    //  カートテーブルからカート内の個数を取得\n                     $amount_select_sql = \"SELECT amount FROM cart_table WHERE item_id = $item_id\";\n                     $data = get_as_array($pdo,$amount_select_sql);\n                     \n                     $amount = $data[0]['amount'];   //  cartから取り出した量\n                     $amount = ++$amount;   //  カート内の個数+1\n                     \n                     // 在庫数確認\n                     $stock_get = \"SELECT stock FROM item_stock_table WHERE item_id = $item_id\";\n                     $stock = get_as_array($pdo,$stock_get);\n                     $stock = $stock[0]['stock'];\n                     \n                     if($stock - $amount >= 0){\n                         \n                         $add_sql = \"UPDATE cart_table SET amount = $amount WHERE item_id = $item_id\";\n                         $stmt=$pdo->query($add_sql);\n                         \n                         $update_date_query = \"UPDATE cart_table SET updated_date = '$date' WHERE item_id = $item_id\";\n                         $stmt=$pdo->query($update_date_query);\n                         \n                         print 'カートに入れました';\n                     }else{\n                         print \"在庫がありません\";\n                     }\n            }\n    }   \n}\n\n// カート内数量変更関数\nfunction cart_amount_change($pdo,$input_err){\n    $sql =\"\";\n    $amount =0;\n    $item_id =0;\n    $stock = \"\";\n    $purchase = \"\";\n    global $date;\n    \n    if(count($input_err) === 0){\n        if($_SERVER['REQUEST_METHOD'] === 'POST'){\n            if(isset($_POST['select_amount']) && isset($_POST['item_id'])){\n                \n                // 入力された数量と商品のidを取得\n                $amount = $_POST['select_amount'];\n                $item_id = $_POST['item_id'];\n                \n                 \n                // 在庫数確認\n                $stock_get = \"SELECT stock FROM item_stock_table WHERE item_id = $item_id\";\n                $stock = get_as_array($pdo,$stock_get);\n                $stock = $stock[0]['stock'];\n                \n                // 変更後数が在庫数を超えていなかった場合\n                if($amount <= $stock){\n                    // 入力された数量に更新\n                    $sql = \"UPDATE cart_table SET amount = $amount WHERE item_id = $item_id\";\n                    $stmt=$pdo->query($sql);\n                    \n                    $update_date_query = \"UPDATE cart_table SET updated_date = '$date' WHERE item_id = $item_id\";\n                    $stmt=$pdo->query($update_date_query);\n                    \n                    print '数量変更完了';\n                }else{\n                    print \"更新失敗\";\n                }\n            }\n        }\n    }else{\n        err_display($input_err);\n    }\n}\n\n// 購入完了関数 \nfunction complete_shopping($pdo,$array,$user_id){\n    \n    if($_SERVER['REQUEST_METHOD'] === 'POST'){\n        if(!empty($array)){\n       \n            try{\n                $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);\n                $pdo->setAttribute(PDO::ATTR_EMULATE_PREPARES, false);\n                // トランザクション開始\n                $pdo->beginTransaction();\n                \n                // 在庫数変更クエリ\n                $sql = \"UPDATE item_stock_table,cart_table SET stock = stock - amount WHERE item_stock_table.item_id = cart_table.item_id AND cart_table.user_id = $user_id\";\n                $stmt=$pdo->query($sql);\n                \n                // カート情報削除クエリ\n                $sql = \"DELETE FROM cart_table WHERE $user_id\";\n                $stmt=$pdo->query($sql);\n                \n                 //コミット\n                $pdo->commit();\n            }catch(PDOException $e){    \n                if(isset($pdo)===true && $pdo->inTransaction()===true){\n                //ロールバックする\n                $pdo->rollBack();\n                }\n             \n                //エラー情報の表示\n                //エラーコード取得\n                $code=$e->getCode();\n                 //エラーメッセージ取得\n                $message=$e->getMessage();\n                \n                print 'sql文の実行が失敗しました';\n                print '<br>';\n                print(\"{$code}/{$message}<brS>\");\n                //プログラム終了\n                die();\n            }\n        }else{\n            print '商品がありません';\n        }\n    }\n    \n}\n\n// // カート内商品削除関数\nfunction delete_cartiteminfo($pdo){\n        $item_id = 0;\n        if($_SERVER['REQUEST_METHOD'] === 'POST'){\n            if(isset($_POST['delete'])){\n                // id取得\n                $item_id = get_post_data('item_id');\n                // カートテーブル\n                $sql = \"DELETE FROM cart_table WHERE item_id= $item_id\";\n                // var_dump($sql);\n                \n                $stmt=$pdo->query($sql);\n                \n            }\n        }\n    \n}\n","undoManager":{"mark":93,"position":100,"stack":[[{"start":{"row":542,"column":9},"end":{"row":542,"column":10},"action":"insert","lines":["e"],"id":909},{"start":{"row":542,"column":10},"end":{"row":542,"column":11},"action":"insert","lines":["l"]},{"start":{"row":542,"column":11},"end":{"row":542,"column":12},"action":"insert","lines":["s"]},{"start":{"row":542,"column":12},"end":{"row":542,"column":13},"action":"insert","lines":["e"]},{"start":{"row":542,"column":13},"end":{"row":542,"column":14},"action":"insert","lines":["{"]}],[{"start":{"row":542,"column":14},"end":{"row":544,"column":9},"action":"insert","lines":["","            ","        }"],"id":910}],[{"start":{"row":543,"column":12},"end":{"row":543,"column":13},"action":"insert","lines":["p"],"id":911},{"start":{"row":543,"column":13},"end":{"row":543,"column":14},"action":"insert","lines":["r"]},{"start":{"row":543,"column":14},"end":{"row":543,"column":15},"action":"insert","lines":["i"]},{"start":{"row":543,"column":15},"end":{"row":543,"column":16},"action":"insert","lines":["n"]},{"start":{"row":543,"column":16},"end":{"row":543,"column":17},"action":"insert","lines":["t"]}],[{"start":{"row":543,"column":17},"end":{"row":543,"column":18},"action":"insert","lines":[" "],"id":912},{"start":{"row":543,"column":18},"end":{"row":543,"column":19},"action":"insert","lines":["2"]},{"start":{"row":543,"column":19},"end":{"row":543,"column":20},"action":"insert","lines":[";"]}],[{"start":{"row":542,"column":9},"end":{"row":544,"column":9},"action":"remove","lines":["else{","            print 2;","        }"],"id":913}],[{"start":{"row":382,"column":35},"end":{"row":383,"column":0},"action":"insert","lines":["",""],"id":914},{"start":{"row":383,"column":0},"end":{"row":383,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":383,"column":4},"end":{"row":383,"column":8},"action":"insert","lines":["    "],"id":915}],[{"start":{"row":383,"column":8},"end":{"row":383,"column":9},"action":"insert","lines":["$"],"id":916},{"start":{"row":383,"column":9},"end":{"row":383,"column":10},"action":"insert","lines":["i"]},{"start":{"row":383,"column":10},"end":{"row":383,"column":11},"action":"insert","lines":["t"]},{"start":{"row":383,"column":11},"end":{"row":383,"column":12},"action":"insert","lines":["e"]},{"start":{"row":383,"column":12},"end":{"row":383,"column":13},"action":"insert","lines":["m"]}],[{"start":{"row":383,"column":8},"end":{"row":383,"column":13},"action":"remove","lines":["$item"],"id":917},{"start":{"row":383,"column":8},"end":{"row":383,"column":16},"action":"insert","lines":["$item_id"]}],[{"start":{"row":383,"column":16},"end":{"row":383,"column":17},"action":"insert","lines":[" "],"id":918},{"start":{"row":383,"column":17},"end":{"row":383,"column":18},"action":"insert","lines":["="]}],[{"start":{"row":383,"column":18},"end":{"row":383,"column":19},"action":"insert","lines":[" "],"id":919},{"start":{"row":383,"column":19},"end":{"row":383,"column":20},"action":"insert","lines":["0"]},{"start":{"row":383,"column":20},"end":{"row":383,"column":21},"action":"insert","lines":[";"]}],[{"start":{"row":496,"column":8},"end":{"row":496,"column":28},"action":"remove","lines":["if(isset($item_id)){"],"id":920},{"start":{"row":496,"column":4},"end":{"row":496,"column":8},"action":"remove","lines":["    "]},{"start":{"row":496,"column":0},"end":{"row":496,"column":4},"action":"remove","lines":["    "]},{"start":{"row":495,"column":73},"end":{"row":496,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":542,"column":8},"end":{"row":542,"column":9},"action":"remove","lines":["}"],"id":922}],[{"start":{"row":493,"column":4},"end":{"row":493,"column":5},"action":"insert","lines":["I"],"id":923}],[{"start":{"row":493,"column":4},"end":{"row":493,"column":5},"action":"remove","lines":["I"],"id":924}],[{"start":{"row":493,"column":4},"end":{"row":493,"column":5},"action":"insert","lines":["i"],"id":925},{"start":{"row":493,"column":5},"end":{"row":493,"column":6},"action":"insert","lines":["s"]},{"start":{"row":493,"column":6},"end":{"row":493,"column":7},"action":"insert","lines":["s"]}],[{"start":{"row":493,"column":6},"end":{"row":493,"column":7},"action":"remove","lines":["s"],"id":926},{"start":{"row":493,"column":5},"end":{"row":493,"column":6},"action":"remove","lines":["s"]}],[{"start":{"row":493,"column":5},"end":{"row":493,"column":6},"action":"insert","lines":["f"],"id":927}],[{"start":{"row":493,"column":6},"end":{"row":493,"column":8},"action":"insert","lines":["()"],"id":928}],[{"start":{"row":493,"column":7},"end":{"row":493,"column":8},"action":"insert","lines":["i"],"id":929},{"start":{"row":493,"column":8},"end":{"row":493,"column":9},"action":"insert","lines":["s"]},{"start":{"row":493,"column":9},"end":{"row":493,"column":10},"action":"insert","lines":["s"]},{"start":{"row":493,"column":10},"end":{"row":493,"column":11},"action":"insert","lines":["s"]},{"start":{"row":493,"column":11},"end":{"row":493,"column":12},"action":"insert","lines":["e"]}],[{"start":{"row":493,"column":11},"end":{"row":493,"column":12},"action":"remove","lines":["e"],"id":930},{"start":{"row":493,"column":10},"end":{"row":493,"column":11},"action":"remove","lines":["s"]}],[{"start":{"row":493,"column":10},"end":{"row":493,"column":11},"action":"insert","lines":["e"],"id":931},{"start":{"row":493,"column":11},"end":{"row":493,"column":12},"action":"insert","lines":["t"]}],[{"start":{"row":493,"column":12},"end":{"row":493,"column":14},"action":"insert","lines":["()"],"id":932}],[{"start":{"row":493,"column":13},"end":{"row":493,"column":14},"action":"insert","lines":["$"],"id":933},{"start":{"row":493,"column":14},"end":{"row":493,"column":15},"action":"insert","lines":["_"]},{"start":{"row":493,"column":15},"end":{"row":493,"column":16},"action":"insert","lines":["P"]},{"start":{"row":493,"column":16},"end":{"row":493,"column":17},"action":"insert","lines":["O"]}],[{"start":{"row":493,"column":17},"end":{"row":493,"column":18},"action":"insert","lines":["S"],"id":934},{"start":{"row":493,"column":18},"end":{"row":493,"column":19},"action":"insert","lines":["T"]}],[{"start":{"row":493,"column":19},"end":{"row":493,"column":21},"action":"insert","lines":["[]"],"id":935}],[{"start":{"row":493,"column":20},"end":{"row":493,"column":40},"action":"insert","lines":["$_POST['additem_id']"],"id":936}],[{"start":{"row":493,"column":25},"end":{"row":493,"column":26},"action":"remove","lines":["T"],"id":937},{"start":{"row":493,"column":24},"end":{"row":493,"column":25},"action":"remove","lines":["S"]},{"start":{"row":493,"column":23},"end":{"row":493,"column":24},"action":"remove","lines":["O"]},{"start":{"row":493,"column":22},"end":{"row":493,"column":23},"action":"remove","lines":["P"]},{"start":{"row":493,"column":21},"end":{"row":493,"column":22},"action":"remove","lines":["_"]},{"start":{"row":493,"column":20},"end":{"row":493,"column":21},"action":"remove","lines":["$"]},{"start":{"row":493,"column":19},"end":{"row":493,"column":20},"action":"remove","lines":["["]}],[{"start":{"row":493,"column":33},"end":{"row":493,"column":34},"action":"remove","lines":["]"],"id":938}],[{"start":{"row":493,"column":35},"end":{"row":493,"column":36},"action":"insert","lines":["{"],"id":939}],[{"start":{"row":542,"column":5},"end":{"row":542,"column":6},"action":"insert","lines":["}"],"id":940},{"start":{"row":542,"column":0},"end":{"row":542,"column":5},"action":"remove","lines":["     "]},{"start":{"row":542,"column":0},"end":{"row":542,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":493,"column":0},"end":{"row":493,"column":4},"action":"insert","lines":["    "],"id":941},{"start":{"row":494,"column":0},"end":{"row":494,"column":4},"action":"insert","lines":["    "]},{"start":{"row":495,"column":0},"end":{"row":495,"column":4},"action":"insert","lines":["    "]},{"start":{"row":496,"column":0},"end":{"row":496,"column":4},"action":"insert","lines":["    "]},{"start":{"row":497,"column":0},"end":{"row":497,"column":4},"action":"insert","lines":["    "]},{"start":{"row":498,"column":0},"end":{"row":498,"column":4},"action":"insert","lines":["    "]},{"start":{"row":499,"column":0},"end":{"row":499,"column":4},"action":"insert","lines":["    "]},{"start":{"row":500,"column":0},"end":{"row":500,"column":4},"action":"insert","lines":["    "]},{"start":{"row":501,"column":0},"end":{"row":501,"column":4},"action":"insert","lines":["    "]},{"start":{"row":502,"column":0},"end":{"row":502,"column":4},"action":"insert","lines":["    "]},{"start":{"row":503,"column":0},"end":{"row":503,"column":4},"action":"insert","lines":["    "]},{"start":{"row":504,"column":0},"end":{"row":504,"column":4},"action":"insert","lines":["    "]},{"start":{"row":505,"column":0},"end":{"row":505,"column":4},"action":"insert","lines":["    "]},{"start":{"row":506,"column":0},"end":{"row":506,"column":4},"action":"insert","lines":["    "]},{"start":{"row":507,"column":0},"end":{"row":507,"column":4},"action":"insert","lines":["    "]},{"start":{"row":508,"column":0},"end":{"row":508,"column":4},"action":"insert","lines":["    "]},{"start":{"row":509,"column":0},"end":{"row":509,"column":4},"action":"insert","lines":["    "]},{"start":{"row":510,"column":0},"end":{"row":510,"column":4},"action":"insert","lines":["    "]},{"start":{"row":511,"column":0},"end":{"row":511,"column":4},"action":"insert","lines":["    "]},{"start":{"row":512,"column":0},"end":{"row":512,"column":4},"action":"insert","lines":["    "]},{"start":{"row":513,"column":0},"end":{"row":513,"column":4},"action":"insert","lines":["    "]},{"start":{"row":514,"column":0},"end":{"row":514,"column":4},"action":"insert","lines":["    "]},{"start":{"row":515,"column":0},"end":{"row":515,"column":4},"action":"insert","lines":["    "]},{"start":{"row":516,"column":0},"end":{"row":516,"column":4},"action":"insert","lines":["    "]},{"start":{"row":517,"column":0},"end":{"row":517,"column":4},"action":"insert","lines":["    "]},{"start":{"row":518,"column":0},"end":{"row":518,"column":4},"action":"insert","lines":["    "]},{"start":{"row":519,"column":0},"end":{"row":519,"column":4},"action":"insert","lines":["    "]},{"start":{"row":520,"column":0},"end":{"row":520,"column":4},"action":"insert","lines":["    "]},{"start":{"row":521,"column":0},"end":{"row":521,"column":4},"action":"insert","lines":["    "]},{"start":{"row":522,"column":0},"end":{"row":522,"column":4},"action":"insert","lines":["    "]},{"start":{"row":523,"column":0},"end":{"row":523,"column":4},"action":"insert","lines":["    "]},{"start":{"row":524,"column":0},"end":{"row":524,"column":4},"action":"insert","lines":["    "]},{"start":{"row":525,"column":0},"end":{"row":525,"column":4},"action":"insert","lines":["    "]},{"start":{"row":526,"column":0},"end":{"row":526,"column":4},"action":"insert","lines":["    "]},{"start":{"row":527,"column":0},"end":{"row":527,"column":4},"action":"insert","lines":["    "]},{"start":{"row":528,"column":0},"end":{"row":528,"column":4},"action":"insert","lines":["    "]},{"start":{"row":529,"column":0},"end":{"row":529,"column":4},"action":"insert","lines":["    "]},{"start":{"row":530,"column":0},"end":{"row":530,"column":4},"action":"insert","lines":["    "]},{"start":{"row":531,"column":0},"end":{"row":531,"column":4},"action":"insert","lines":["    "]},{"start":{"row":532,"column":0},"end":{"row":532,"column":4},"action":"insert","lines":["    "]},{"start":{"row":533,"column":0},"end":{"row":533,"column":4},"action":"insert","lines":["    "]},{"start":{"row":534,"column":0},"end":{"row":534,"column":4},"action":"insert","lines":["    "]},{"start":{"row":535,"column":0},"end":{"row":535,"column":4},"action":"insert","lines":["    "]},{"start":{"row":536,"column":0},"end":{"row":536,"column":4},"action":"insert","lines":["    "]},{"start":{"row":537,"column":0},"end":{"row":537,"column":4},"action":"insert","lines":["    "]},{"start":{"row":538,"column":0},"end":{"row":538,"column":4},"action":"insert","lines":["    "]},{"start":{"row":539,"column":0},"end":{"row":539,"column":4},"action":"insert","lines":["    "]},{"start":{"row":540,"column":0},"end":{"row":540,"column":4},"action":"insert","lines":["    "]},{"start":{"row":541,"column":0},"end":{"row":541,"column":4},"action":"insert","lines":["    "]},{"start":{"row":542,"column":0},"end":{"row":542,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":493,"column":4},"end":{"row":493,"column":8},"action":"remove","lines":["    "],"id":942},{"start":{"row":494,"column":0},"end":{"row":494,"column":3},"action":"remove","lines":["   "]},{"start":{"row":494,"column":8},"end":{"row":494,"column":9},"action":"remove","lines":[" "]},{"start":{"row":495,"column":0},"end":{"row":495,"column":4},"action":"remove","lines":["    "]},{"start":{"row":496,"column":0},"end":{"row":496,"column":1},"action":"remove","lines":[" "]},{"start":{"row":496,"column":12},"end":{"row":496,"column":15},"action":"remove","lines":["   "]},{"start":{"row":497,"column":0},"end":{"row":497,"column":4},"action":"remove","lines":["    "]},{"start":{"row":498,"column":19},"end":{"row":498,"column":23},"action":"remove","lines":["    "]},{"start":{"row":499,"column":0},"end":{"row":499,"column":1},"action":"remove","lines":[" "]},{"start":{"row":499,"column":20},"end":{"row":499,"column":23},"action":"remove","lines":["   "]},{"start":{"row":500,"column":0},"end":{"row":500,"column":4},"action":"remove","lines":["    "]},{"start":{"row":501,"column":20},"end":{"row":501,"column":24},"action":"remove","lines":["    "]},{"start":{"row":502,"column":0},"end":{"row":502,"column":2},"action":"remove","lines":["  "]},{"start":{"row":502,"column":20},"end":{"row":502,"column":22},"action":"remove","lines":["  "]},{"start":{"row":503,"column":0},"end":{"row":503,"column":4},"action":"remove","lines":["    "]},{"start":{"row":504,"column":20},"end":{"row":504,"column":24},"action":"remove","lines":["    "]},{"start":{"row":505,"column":0},"end":{"row":505,"column":2},"action":"remove","lines":["  "]},{"start":{"row":505,"column":20},"end":{"row":505,"column":22},"action":"remove","lines":["  "]},{"start":{"row":506,"column":0},"end":{"row":506,"column":4},"action":"remove","lines":["    "]},{"start":{"row":507,"column":20},"end":{"row":507,"column":24},"action":"remove","lines":["    "]},{"start":{"row":508,"column":0},"end":{"row":508,"column":3},"action":"remove","lines":["   "]},{"start":{"row":508,"column":20},"end":{"row":508,"column":21},"action":"remove","lines":[" "]},{"start":{"row":509,"column":0},"end":{"row":509,"column":4},"action":"remove","lines":["    "]},{"start":{"row":510,"column":20},"end":{"row":510,"column":24},"action":"remove","lines":["    "]},{"start":{"row":511,"column":0},"end":{"row":511,"column":3},"action":"remove","lines":["   "]},{"start":{"row":511,"column":20},"end":{"row":511,"column":21},"action":"remove","lines":[" "]},{"start":{"row":512,"column":12},"end":{"row":512,"column":16},"action":"remove","lines":["    "]},{"start":{"row":513,"column":0},"end":{"row":513,"column":2},"action":"remove","lines":["  "]},{"start":{"row":513,"column":12},"end":{"row":513,"column":14},"action":"remove","lines":["  "]},{"start":{"row":514,"column":0},"end":{"row":514,"column":4},"action":"remove","lines":["    "]},{"start":{"row":515,"column":17},"end":{"row":515,"column":21},"action":"remove","lines":["    "]},{"start":{"row":516,"column":0},"end":{"row":516,"column":4},"action":"remove","lines":["    "]},{"start":{"row":517,"column":0},"end":{"row":517,"column":4},"action":"remove","lines":["    "]},{"start":{"row":518,"column":21},"end":{"row":518,"column":25},"action":"remove","lines":["    "]},{"start":{"row":519,"column":21},"end":{"row":519,"column":25},"action":"remove","lines":["    "]},{"start":{"row":520,"column":21},"end":{"row":520,"column":25},"action":"remove","lines":["    "]},{"start":{"row":521,"column":0},"end":{"row":521,"column":1},"action":"remove","lines":[" "]},{"start":{"row":521,"column":21},"end":{"row":521,"column":24},"action":"remove","lines":["   "]},{"start":{"row":522,"column":0},"end":{"row":522,"column":4},"action":"remove","lines":["    "]},{"start":{"row":523,"column":21},"end":{"row":523,"column":25},"action":"remove","lines":["    "]},{"start":{"row":524,"column":0},"end":{"row":524,"column":1},"action":"remove","lines":[" "]},{"start":{"row":524,"column":21},"end":{"row":524,"column":24},"action":"remove","lines":["   "]},{"start":{"row":525,"column":0},"end":{"row":525,"column":4},"action":"remove","lines":["    "]},{"start":{"row":526,"column":21},"end":{"row":526,"column":25},"action":"remove","lines":["    "]},{"start":{"row":527,"column":0},"end":{"row":527,"column":2},"action":"remove","lines":["  "]},{"start":{"row":527,"column":21},"end":{"row":527,"column":23},"action":"remove","lines":["  "]},{"start":{"row":528,"column":0},"end":{"row":528,"column":4},"action":"remove","lines":["    "]},{"start":{"row":529,"column":21},"end":{"row":529,"column":25},"action":"remove","lines":["    "]},{"start":{"row":530,"column":0},"end":{"row":530,"column":2},"action":"remove","lines":["  "]},{"start":{"row":530,"column":25},"end":{"row":530,"column":27},"action":"remove","lines":["  "]},{"start":{"row":531,"column":0},"end":{"row":531,"column":4},"action":"remove","lines":["    "]},{"start":{"row":532,"column":25},"end":{"row":532,"column":29},"action":"remove","lines":["    "]},{"start":{"row":533,"column":0},"end":{"row":533,"column":3},"action":"remove","lines":["   "]},{"start":{"row":533,"column":25},"end":{"row":533,"column":26},"action":"remove","lines":[" "]},{"start":{"row":534,"column":0},"end":{"row":534,"column":4},"action":"remove","lines":["    "]},{"start":{"row":535,"column":25},"end":{"row":535,"column":29},"action":"remove","lines":["    "]},{"start":{"row":536,"column":0},"end":{"row":536,"column":3},"action":"remove","lines":["   "]},{"start":{"row":536,"column":25},"end":{"row":536,"column":26},"action":"remove","lines":[" "]},{"start":{"row":537,"column":0},"end":{"row":537,"column":4},"action":"remove","lines":["    "]},{"start":{"row":538,"column":21},"end":{"row":538,"column":25},"action":"remove","lines":["    "]},{"start":{"row":539,"column":0},"end":{"row":539,"column":4},"action":"remove","lines":["    "]},{"start":{"row":540,"column":21},"end":{"row":540,"column":25},"action":"remove","lines":["    "]},{"start":{"row":541,"column":0},"end":{"row":541,"column":4},"action":"remove","lines":["    "]},{"start":{"row":542,"column":0},"end":{"row":542,"column":4},"action":"remove","lines":["    "]}],[{"start":{"row":554,"column":32},"end":{"row":555,"column":0},"action":"insert","lines":["",""],"id":943},{"start":{"row":555,"column":0},"end":{"row":555,"column":8},"action":"insert","lines":["        "]},{"start":{"row":555,"column":8},"end":{"row":555,"column":9},"action":"insert","lines":["i"]},{"start":{"row":555,"column":9},"end":{"row":555,"column":10},"action":"insert","lines":["F"]}],[{"start":{"row":555,"column":9},"end":{"row":555,"column":10},"action":"remove","lines":["F"],"id":944}],[{"start":{"row":555,"column":9},"end":{"row":555,"column":10},"action":"insert","lines":["f"],"id":945}],[{"start":{"row":555,"column":10},"end":{"row":555,"column":12},"action":"insert","lines":["()"],"id":946}],[{"start":{"row":555,"column":11},"end":{"row":555,"column":12},"action":"insert","lines":["$"],"id":947},{"start":{"row":555,"column":12},"end":{"row":555,"column":13},"action":"insert","lines":["_"]}],[{"start":{"row":555,"column":11},"end":{"row":555,"column":14},"action":"remove","lines":["$_)"],"id":949},{"start":{"row":555,"column":11},"end":{"row":555,"column":50},"action":"insert","lines":["$_SERVER['REQUEST_METHOD'] === 'POST'){"]}],[{"start":{"row":581,"column":9},"end":{"row":582,"column":0},"action":"insert","lines":["",""],"id":950},{"start":{"row":582,"column":0},"end":{"row":582,"column":8},"action":"insert","lines":["        "]},{"start":{"row":582,"column":8},"end":{"row":582,"column":9},"action":"insert","lines":["}"]}],[{"start":{"row":556,"column":0},"end":{"row":556,"column":4},"action":"insert","lines":["    "],"id":951},{"start":{"row":557,"column":0},"end":{"row":557,"column":4},"action":"insert","lines":["    "]},{"start":{"row":558,"column":0},"end":{"row":558,"column":4},"action":"insert","lines":["    "]},{"start":{"row":559,"column":0},"end":{"row":559,"column":4},"action":"insert","lines":["    "]},{"start":{"row":560,"column":0},"end":{"row":560,"column":4},"action":"insert","lines":["    "]},{"start":{"row":561,"column":0},"end":{"row":561,"column":4},"action":"insert","lines":["    "]},{"start":{"row":562,"column":0},"end":{"row":562,"column":4},"action":"insert","lines":["    "]},{"start":{"row":563,"column":0},"end":{"row":563,"column":4},"action":"insert","lines":["    "]},{"start":{"row":564,"column":0},"end":{"row":564,"column":4},"action":"insert","lines":["    "]},{"start":{"row":565,"column":0},"end":{"row":565,"column":4},"action":"insert","lines":["    "]},{"start":{"row":566,"column":0},"end":{"row":566,"column":4},"action":"insert","lines":["    "]},{"start":{"row":567,"column":0},"end":{"row":567,"column":4},"action":"insert","lines":["    "]},{"start":{"row":568,"column":0},"end":{"row":568,"column":4},"action":"insert","lines":["    "]},{"start":{"row":569,"column":0},"end":{"row":569,"column":4},"action":"insert","lines":["    "]},{"start":{"row":570,"column":0},"end":{"row":570,"column":4},"action":"insert","lines":["    "]},{"start":{"row":571,"column":0},"end":{"row":571,"column":4},"action":"insert","lines":["    "]},{"start":{"row":572,"column":0},"end":{"row":572,"column":4},"action":"insert","lines":["    "]},{"start":{"row":573,"column":0},"end":{"row":573,"column":4},"action":"insert","lines":["    "]},{"start":{"row":574,"column":0},"end":{"row":574,"column":4},"action":"insert","lines":["    "]},{"start":{"row":575,"column":0},"end":{"row":575,"column":4},"action":"insert","lines":["    "]},{"start":{"row":576,"column":0},"end":{"row":576,"column":4},"action":"insert","lines":["    "]},{"start":{"row":577,"column":0},"end":{"row":577,"column":4},"action":"insert","lines":["    "]},{"start":{"row":578,"column":0},"end":{"row":578,"column":4},"action":"insert","lines":["    "]},{"start":{"row":579,"column":0},"end":{"row":579,"column":4},"action":"insert","lines":["    "]},{"start":{"row":580,"column":0},"end":{"row":580,"column":4},"action":"insert","lines":["    "]},{"start":{"row":581,"column":0},"end":{"row":581,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":383,"column":21},"end":{"row":384,"column":0},"action":"insert","lines":["",""],"id":952},{"start":{"row":384,"column":0},"end":{"row":384,"column":8},"action":"insert","lines":["        "]}],[{"start":{"row":384,"column":8},"end":{"row":384,"column":50},"action":"insert","lines":["if($_SERVER['REQUEST_METHOD'] === 'POST'){"],"id":953}],[{"start":{"row":394,"column":9},"end":{"row":395,"column":0},"action":"insert","lines":["",""],"id":954},{"start":{"row":395,"column":0},"end":{"row":395,"column":8},"action":"insert","lines":["        "]},{"start":{"row":395,"column":8},"end":{"row":395,"column":9},"action":"insert","lines":["}"]}],[{"start":{"row":385,"column":8},"end":{"row":385,"column":9},"action":"remove","lines":[" "],"id":955}],[{"start":{"row":385,"column":0},"end":{"row":385,"column":4},"action":"insert","lines":["    "],"id":956},{"start":{"row":386,"column":0},"end":{"row":386,"column":4},"action":"insert","lines":["    "]},{"start":{"row":387,"column":0},"end":{"row":387,"column":4},"action":"insert","lines":["    "]},{"start":{"row":388,"column":0},"end":{"row":388,"column":4},"action":"insert","lines":["    "]},{"start":{"row":389,"column":0},"end":{"row":389,"column":4},"action":"insert","lines":["    "]},{"start":{"row":390,"column":0},"end":{"row":390,"column":4},"action":"insert","lines":["    "]},{"start":{"row":391,"column":0},"end":{"row":391,"column":4},"action":"insert","lines":["    "]},{"start":{"row":392,"column":0},"end":{"row":392,"column":4},"action":"insert","lines":["    "]},{"start":{"row":393,"column":0},"end":{"row":393,"column":4},"action":"insert","lines":["    "]},{"start":{"row":394,"column":0},"end":{"row":394,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":483,"column":0},"end":{"row":484,"column":0},"action":"insert","lines":["",""],"id":957},{"start":{"row":484,"column":0},"end":{"row":485,"column":0},"action":"insert","lines":["",""]}],[{"start":{"row":485,"column":0},"end":{"row":485,"column":2},"action":"insert","lines":["以下"],"id":958}],[{"start":{"row":485,"column":2},"end":{"row":485,"column":3},"action":"insert","lines":["c"],"id":959},{"start":{"row":485,"column":3},"end":{"row":485,"column":4},"action":"insert","lines":["a"]},{"start":{"row":485,"column":4},"end":{"row":485,"column":5},"action":"insert","lines":["r"]}],[{"start":{"row":485,"column":5},"end":{"row":485,"column":6},"action":"insert","lines":["t"],"id":960},{"start":{"row":485,"column":6},"end":{"row":485,"column":7},"action":"insert","lines":["."]},{"start":{"row":485,"column":7},"end":{"row":485,"column":8},"action":"insert","lines":["p"]},{"start":{"row":485,"column":8},"end":{"row":485,"column":9},"action":"insert","lines":["h"]},{"start":{"row":485,"column":9},"end":{"row":485,"column":10},"action":"insert","lines":["p"]}],[{"start":{"row":485,"column":2},"end":{"row":485,"column":3},"action":"insert","lines":["e"],"id":961},{"start":{"row":485,"column":3},"end":{"row":485,"column":4},"action":"insert","lines":["c"]},{"start":{"row":485,"column":4},"end":{"row":485,"column":5},"action":"insert","lines":["_"]}],[{"start":{"row":485,"column":13},"end":{"row":485,"column":15},"action":"insert","lines":["内で"],"id":962}],[{"start":{"row":485,"column":15},"end":{"row":485,"column":19},"action":"insert","lines":["使用する"],"id":963}],[{"start":{"row":485,"column":19},"end":{"row":485,"column":21},"action":"insert","lines":["関数"],"id":964}],[{"start":{"row":485,"column":0},"end":{"row":485,"column":3},"action":"insert","lines":["// "],"id":965}],[{"start":{"row":639,"column":0},"end":{"row":644,"column":1},"action":"remove","lines":["// エラー表示関数","function err_display($input_err){","    foreach($input_err as $go){","        print $go;","    }","}"],"id":966}],[{"start":{"row":152,"column":0},"end":{"row":157,"column":1},"action":"insert","lines":["// エラー表示関数","function err_display($input_err){","    foreach($input_err as $go){","        print $go;","    }","}"],"id":967}],[{"start":{"row":0,"column":5},"end":{"row":1,"column":0},"action":"insert","lines":["",""],"id":968},{"start":{"row":1,"column":0},"end":{"row":2,"column":0},"action":"insert","lines":["",""]}],[{"start":{"row":2,"column":0},"end":{"row":2,"column":2},"action":"insert","lines":["共通"],"id":969}],[{"start":{"row":2,"column":0},"end":{"row":2,"column":4},"action":"insert","lines":["前ぺ＾字"],"id":970}],[{"start":{"row":2,"column":3},"end":{"row":2,"column":4},"action":"remove","lines":["字"],"id":971},{"start":{"row":2,"column":2},"end":{"row":2,"column":3},"action":"remove","lines":["＾"]}],[{"start":{"row":2,"column":2},"end":{"row":2,"column":4},"action":"insert","lines":["ージ"],"id":972}],[{"start":{"row":2,"column":6},"end":{"row":2,"column":8},"action":"insert","lines":["関数"],"id":973}],[{"start":{"row":2,"column":0},"end":{"row":2,"column":3},"action":"insert","lines":["// "],"id":974}],[{"start":{"row":160,"column":0},"end":{"row":161,"column":0},"action":"insert","lines":["",""],"id":975},{"start":{"row":161,"column":0},"end":{"row":162,"column":0},"action":"insert","lines":["",""]}],[{"start":{"row":162,"column":0},"end":{"row":162,"column":2},"action":"insert","lines":["以下"],"id":976},{"start":{"row":162,"column":2},"end":{"row":162,"column":3},"action":"insert","lines":["i"]},{"start":{"row":162,"column":3},"end":{"row":162,"column":4},"action":"insert","lines":["t"]},{"start":{"row":162,"column":4},"end":{"row":162,"column":5},"action":"insert","lines":["e"]},{"start":{"row":162,"column":5},"end":{"row":162,"column":6},"action":"insert","lines":["m"]}],[{"start":{"row":162,"column":2},"end":{"row":162,"column":3},"action":"insert","lines":["e"],"id":977},{"start":{"row":162,"column":3},"end":{"row":162,"column":4},"action":"insert","lines":["c"]},{"start":{"row":162,"column":4},"end":{"row":162,"column":5},"action":"insert","lines":["_"]}],[{"start":{"row":162,"column":9},"end":{"row":162,"column":10},"action":"insert","lines":["_"],"id":978}],[{"start":{"row":162,"column":10},"end":{"row":162,"column":11},"action":"insert","lines":["r"],"id":979},{"start":{"row":162,"column":11},"end":{"row":162,"column":12},"action":"insert","lines":["e"]},{"start":{"row":162,"column":12},"end":{"row":162,"column":13},"action":"insert","lines":["g"]},{"start":{"row":162,"column":13},"end":{"row":162,"column":14},"action":"insert","lines":["i"]},{"start":{"row":162,"column":14},"end":{"row":162,"column":15},"action":"insert","lines":["s"]},{"start":{"row":162,"column":15},"end":{"row":162,"column":16},"action":"insert","lines":["t"]}],[{"start":{"row":162,"column":15},"end":{"row":162,"column":16},"action":"remove","lines":["t"],"id":980},{"start":{"row":162,"column":14},"end":{"row":162,"column":15},"action":"remove","lines":["s"]},{"start":{"row":162,"column":13},"end":{"row":162,"column":14},"action":"remove","lines":["i"]},{"start":{"row":162,"column":12},"end":{"row":162,"column":13},"action":"remove","lines":["g"]},{"start":{"row":162,"column":11},"end":{"row":162,"column":12},"action":"remove","lines":["e"]},{"start":{"row":162,"column":10},"end":{"row":162,"column":11},"action":"remove","lines":["r"]},{"start":{"row":162,"column":9},"end":{"row":162,"column":10},"action":"remove","lines":["_"]}],[{"start":{"row":162,"column":9},"end":{"row":162,"column":10},"action":"insert","lines":["t"],"id":981},{"start":{"row":162,"column":10},"end":{"row":162,"column":11},"action":"insert","lines":["e"]},{"start":{"row":162,"column":11},"end":{"row":162,"column":12},"action":"insert","lines":["g"]},{"start":{"row":162,"column":12},"end":{"row":162,"column":13},"action":"insert","lines":["i"]},{"start":{"row":162,"column":13},"end":{"row":162,"column":14},"action":"insert","lines":["s"]},{"start":{"row":162,"column":14},"end":{"row":162,"column":15},"action":"insert","lines":["t"]},{"start":{"row":162,"column":15},"end":{"row":162,"column":16},"action":"insert","lines":["e"]},{"start":{"row":162,"column":16},"end":{"row":162,"column":17},"action":"insert","lines":["r"]}],[{"start":{"row":162,"column":17},"end":{"row":162,"column":18},"action":"insert","lines":["."],"id":982}],[{"start":{"row":162,"column":17},"end":{"row":162,"column":18},"action":"remove","lines":["."],"id":983}],[{"start":{"row":162,"column":17},"end":{"row":162,"column":22},"action":"insert","lines":["で使用する"],"id":984},{"start":{"row":162,"column":22},"end":{"row":162,"column":24},"action":"insert","lines":["関数"]}],[{"start":{"row":162,"column":0},"end":{"row":162,"column":3},"action":"insert","lines":["// "],"id":985}],[{"start":{"row":249,"column":0},"end":{"row":273,"column":1},"action":"remove","lines":["// db接続関数","function get_db_connect() {","            $username = 'codecamp49497';","            $passwd = 'codecamp49497';","        try{","            // pdoによるMYSQLへの接続","            $pdo = new PDO('mysql:host=localhost;dbname=codecamp49497;charset=utf8;',$username,$passwd);","            //例外をスロ-","            $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);","            $pdo->setAttribute(PDO::ATTR_EMULATE_PREPARES, false);","            ","        }catch(PDOException $e){","            //エラー情報の表示","            //エラーコード取得","            $code=$e->getCode();","            //エラーメッセージ取得","            $message=$e->getMessage();","            print '接続失敗しました';","            print '<br>';","            print(\"{$code}/{$message}<brS>\");","            //プログラム終了","            die();","        }","            return $pdo;","}"],"id":986}],[{"start":{"row":159,"column":2},"end":{"row":159,"column":16},"action":"remove","lines":["              "],"id":987},{"start":{"row":159,"column":2},"end":{"row":160,"column":0},"action":"insert","lines":["",""]},{"start":{"row":160,"column":0},"end":{"row":161,"column":0},"action":"insert","lines":["",""]}],[{"start":{"row":161,"column":0},"end":{"row":185,"column":1},"action":"insert","lines":["// db接続関数","function get_db_connect() {","            $username = 'codecamp49497';","            $passwd = 'codecamp49497';","        try{","            // pdoによるMYSQLへの接続","            $pdo = new PDO('mysql:host=localhost;dbname=codecamp49497;charset=utf8;',$username,$passwd);","            //例外をスロ-","            $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);","            $pdo->setAttribute(PDO::ATTR_EMULATE_PREPARES, false);","            ","        }catch(PDOException $e){","            //エラー情報の表示","            //エラーコード取得","            $code=$e->getCode();","            //エラーメッセージ取得","            $message=$e->getMessage();","            print '接続失敗しました';","            print '<br>';","            print(\"{$code}/{$message}<brS>\");","            //プログラム終了","            die();","        }","            return $pdo;","}"],"id":988}],[{"start":{"row":350,"column":0},"end":{"row":373,"column":1},"action":"remove","lines":["// 管理者ブラウザに表示する表の作成"," function table_display($pdo){","    $data_array =[];","    // 表作成のためのカラム取得","    $sql = \"SELECT item_info_table.id,name,img,price,stock,status FROM item_info_table JOIN item_stock_table ON item_info_table.id = item_stock_table.item_id\";","    $stmt=$pdo->query($sql);","    ","    while($row=$stmt->fetch()){","        $data_array[] = $row;","    }","    ","    return $data_array;"," }"," "," function user_table($pdo,$sql){","     $data =[];","     $stmt=$pdo->query($sql);","     while($row=$stmt->fetch()){","        $data[] = $row;","    }","    ","    return $data;"," }"," "],"id":989}],[{"start":{"row":185,"column":1},"end":{"row":186,"column":0},"action":"insert","lines":["",""],"id":990},{"start":{"row":186,"column":0},"end":{"row":187,"column":0},"action":"insert","lines":["",""]}],[{"start":{"row":187,"column":0},"end":{"row":210,"column":1},"action":"insert","lines":["// 管理者ブラウザに表示する表の作成"," function table_display($pdo){","    $data_array =[];","    // 表作成のためのカラム取得","    $sql = \"SELECT item_info_table.id,name,img,price,stock,status FROM item_info_table JOIN item_stock_table ON item_info_table.id = item_stock_table.item_id\";","    $stmt=$pdo->query($sql);","    ","    while($row=$stmt->fetch()){","        $data_array[] = $row;","    }","    ","    return $data_array;"," }"," "," function user_table($pdo,$sql){","     $data =[];","     $stmt=$pdo->query($sql);","     while($row=$stmt->fetch()){","        $data[] = $row;","    }","    ","    return $data;"," }"," "],"id":991}],[{"start":{"row":394,"column":0},"end":{"row":410,"column":1},"action":"remove","lines":["// // カート内商品削除関数","function delete_cartiteminfo($pdo){","        $item_id = 0;","        if($_SERVER['REQUEST_METHOD'] === 'POST'){","            if(isset($_POST['delete'])){","                // id取得","                $item_id = get_post_data('item_id');","                // カートテーブル","                $sql = \"DELETE FROM cart_table WHERE item_id= $item_id\";","                // var_dump($sql);","                ","                $stmt=$pdo->query($sql);","                ","            }","        }","    ","}"],"id":992}],[{"start":{"row":635,"column":0},"end":{"row":636,"column":0},"action":"insert","lines":["",""],"id":993}],[{"start":{"row":636,"column":0},"end":{"row":652,"column":1},"action":"insert","lines":["// // カート内商品削除関数","function delete_cartiteminfo($pdo){","        $item_id = 0;","        if($_SERVER['REQUEST_METHOD'] === 'POST'){","            if(isset($_POST['delete'])){","                // id取得","                $item_id = get_post_data('item_id');","                // カートテーブル","                $sql = \"DELETE FROM cart_table WHERE item_id= $item_id\";","                // var_dump($sql);","                ","                $stmt=$pdo->query($sql);","                ","            }","        }","    ","}"],"id":994}],[{"start":{"row":377,"column":2},"end":{"row":377,"column":3},"action":"remove","lines":[" "],"id":995},{"start":{"row":377,"column":1},"end":{"row":377,"column":2},"action":"remove","lines":["/"]},{"start":{"row":377,"column":0},"end":{"row":377,"column":1},"action":"remove","lines":["/"]}],[{"start":{"row":396,"column":0},"end":{"row":396,"column":2},"action":"insert","lines":["以下"],"id":996},{"start":{"row":396,"column":2},"end":{"row":396,"column":3},"action":"insert","lines":["e"]},{"start":{"row":396,"column":3},"end":{"row":396,"column":4},"action":"insert","lines":["c"]}],[{"start":{"row":396,"column":4},"end":{"row":396,"column":5},"action":"insert","lines":["_"],"id":997},{"start":{"row":396,"column":5},"end":{"row":396,"column":6},"action":"insert","lines":["u"]}],[{"start":{"row":396,"column":6},"end":{"row":396,"column":7},"action":"insert","lines":["s"],"id":998},{"start":{"row":396,"column":7},"end":{"row":396,"column":8},"action":"insert","lines":["e"]},{"start":{"row":396,"column":8},"end":{"row":396,"column":9},"action":"insert","lines":["r"]},{"start":{"row":396,"column":9},"end":{"row":396,"column":10},"action":"insert","lines":["r"]},{"start":{"row":396,"column":10},"end":{"row":396,"column":11},"action":"insert","lines":["e"]},{"start":{"row":396,"column":11},"end":{"row":396,"column":12},"action":"insert","lines":["g"]},{"start":{"row":396,"column":12},"end":{"row":396,"column":13},"action":"insert","lines":["i"]},{"start":{"row":396,"column":13},"end":{"row":396,"column":14},"action":"insert","lines":["s"]}],[{"start":{"row":396,"column":14},"end":{"row":396,"column":15},"action":"insert","lines":["t"],"id":999},{"start":{"row":396,"column":15},"end":{"row":396,"column":16},"action":"insert","lines":["e"]},{"start":{"row":396,"column":16},"end":{"row":396,"column":17},"action":"insert","lines":["e"]}],[{"start":{"row":396,"column":16},"end":{"row":396,"column":17},"action":"remove","lines":["e"],"id":1000}],[{"start":{"row":396,"column":16},"end":{"row":396,"column":17},"action":"insert","lines":["r"],"id":1001}],[{"start":{"row":396,"column":17},"end":{"row":396,"column":23},"action":"insert","lines":["内で使用する"],"id":1002},{"start":{"row":396,"column":23},"end":{"row":396,"column":25},"action":"insert","lines":["関数"]}],[{"start":{"row":396,"column":0},"end":{"row":396,"column":3},"action":"insert","lines":["// "],"id":1003}],[{"start":{"row":2,"column":3},"end":{"row":2,"column":4},"action":"remove","lines":["前"],"id":1004}],[{"start":{"row":394,"column":0},"end":{"row":395,"column":0},"action":"remove","lines":["",""],"id":1005},{"start":{"row":393,"column":1},"end":{"row":394,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":393,"column":1},"end":{"row":394,"column":0},"action":"insert","lines":["",""],"id":1006}],[{"start":{"row":375,"column":0},"end":{"row":376,"column":0},"action":"remove","lines":["",""],"id":1007},{"start":{"row":374,"column":1},"end":{"row":375,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":302,"column":0},"end":{"row":303,"column":1},"action":"remove","lines":[""," "],"id":1008},{"start":{"row":301,"column":0},"end":{"row":302,"column":0},"action":"remove","lines":["",""]},{"start":{"row":300,"column":0},"end":{"row":301,"column":0},"action":"remove","lines":["",""]},{"start":{"row":299,"column":11},"end":{"row":300,"column":0},"action":"remove","lines":["",""]},{"start":{"row":299,"column":10},"end":{"row":299,"column":11},"action":"remove","lines":[" "]},{"start":{"row":299,"column":9},"end":{"row":299,"column":10},"action":"remove","lines":[" "]},{"start":{"row":299,"column":8},"end":{"row":299,"column":9},"action":"remove","lines":[" "]}],[{"start":{"row":299,"column":4},"end":{"row":299,"column":8},"action":"remove","lines":["    "],"id":1009},{"start":{"row":299,"column":0},"end":{"row":299,"column":4},"action":"remove","lines":["    "]}],[{"start":{"row":211,"column":0},"end":{"row":212,"column":0},"action":"remove","lines":["",""],"id":1010},{"start":{"row":210,"column":1},"end":{"row":211,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":133,"column":13},"end":{"row":133,"column":14},"action":"remove","lines":[" "],"id":1011},{"start":{"row":133,"column":12},"end":{"row":133,"column":13},"action":"remove","lines":[" "]},{"start":{"row":133,"column":8},"end":{"row":133,"column":12},"action":"remove","lines":["    "]},{"start":{"row":133,"column":4},"end":{"row":133,"column":8},"action":"remove","lines":["    "]},{"start":{"row":133,"column":0},"end":{"row":133,"column":4},"action":"remove","lines":["    "]},{"start":{"row":132,"column":0},"end":{"row":133,"column":1},"action":"remove","lines":[""," "]},{"start":{"row":131,"column":0},"end":{"row":132,"column":0},"action":"remove","lines":["",""]}]]},"ace":{"folds":[],"scrolltop":9202,"scrollleft":0,"selection":{"start":{"row":131,"column":0},"end":{"row":131,"column":0},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":612,"state":"php-start","mode":"ace/mode/php"}},"timestamp":1641276568763}