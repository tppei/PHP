{"changed":true,"filter":false,"title":"result.php","tooltip":"/htdocs/drink/result.php","value":"<?php\n$regexp_price = '/^[0-9]+$/';   //半角数字の正規表現\n\n$host = 'localhost';            // データベースのホスト名\n$username = 'codecamp49497';    // MySQLのユーザ名\n$passwd   = 'codecamp49497';    // MySQLのパスワード\n$dbname   = 'codecamp49497';    // データベース名\n$link = mysqli_connect($host, $username, $passwd, $dbname);\n\n// 変数初期化\n$drink_id = '';\n$post_err = [];\n$err_msg = [];\n?>\n<!DOCTYPE html>\n<html lang=\"ja\">\n    <body>\n        <h1>自動販売機結果</h1>\n    <?php\n    \n    // 投入金額のエラー\n    \n    // 投入金額が入力されていない\n    if(!$_POST['money']){\n        print '<p>投入金額を入力してください</p>';\n        $post_err[] = '投入金額を入力してください';\n    }else if(!preg_match($regexp_price,$_POST['money'])){\n        // 投入金額が正規表現外\n        print  \"<p>投入金額は半角数字を入力してください</p>\";\n        $post_err[] = \"投入金額は半角数字を入力してください\";\n    }else if($_POST['money'] > 10000){\n        // 投入金額が１万以上\n        print \"<p>投入金額は1万円以下にしてください</p>\";\n        $post_err[] = \"投入金額は1万円以下にしてください\";\n    }\n    \n    // 購入商品が選択されていないときのエラー\n    if(!$_POST['drink_id']){\n        print '<p>購入する商品を選択してください</p>';\n        $post_err[] = '購入する商品を選択してください';\n    }\n    \n    // 投入金額と選択商品にエラーがないとき\n    if(count($post_err) === 0){\n        \n        // 現在時刻を取得\n        $date = date('Y-m-d H:i:s');\n        \n        // ドリンクid取得\n        $drink_id = $_POST['drink_id'];\n        \n         // トランザクション開始\n        mysqli_autocommit($link, false);\n        \n        \n        \n        if($link){\n            \n            // 文字コードセット\n            mysqli_set_charset($link, 'UTF8');\n            \n            // 購入した商品情報取得のためのクエリ\n            $sql = \"SELECT drink_details.ドリンクid,ドリンク名,商品画像,価格,在庫数,公開ステータス FROM drink_details JOIN drink_stock_table ON drink_details.ドリンクid = drink_stock_table.ドリンクid WHERE drink_details.ドリンクid = '$drink_id'\";\n            \n            if($result = mysqli_query($link,$sql)){\n                // 確認用\n                // var_dump($drink_id);\n                \n                // 結果を一行取り出す\n                while($row = mysqli_fetch_assoc($result)){\n                    \n                    // 購入したドリンク名取得\n                    $drink_name = htmlspecialchars($row['ドリンク名']);\n                    \n                    // 購入したドリンクのステータス取得　修正箇所　12/2/'21\n                    $status = htmlspecialchars($row['公開ステータス']);\n                    \n                    // 購入したドリンクの在庫数取得　修正箇所　12/2/'21\n                    $stock = htmlspecialchars($row['在庫数']);\n                    \n                    // 購入した商品画像取得　修正箇所　12/2/'21\n                    $image = $row['商品画像'];\n                    \n                     // 購入した商品価格取得　修正箇所　12/2/'21\n                    $price = $row['価格'];\n                    \n                }\n                \n                // 公開ステータスが非公開の場合購入できない　修正箇所　12/2/'21\n                if($status === '0'){\n                        \n                    print '現在購入できません';\n                        \n                }else{\n                        \n                    // おつり計算\n                    $charge = $_POST['money'] - $price;\n                        \n                    // 在庫数が0個以下の場合購入できない　修正箇所　12/2/'21    \n                    if($stock <= 0){\n                        \n                        print '売り切れました！';\n                        \n                    }else{\n                \n                        // 現在の在庫数から一つひく\n                        $stock = $stock - 1;\n                        \n                        // 投入金額 - 価格　< 0　の時\n                        if($charge < 0){\n                            print 'お金が足りません';\n                        }else{\n                    \n                        // 購入履歴表(drink_history_table)に購入日追加\n                        $tohistory_sql = \"INSERT INTO drink_history_table (ドリンクID,購入日) VALUES($drink_id,'$date')\";\n                            if(!$result = mysqli_query($link,$tohistory_sql)){\n                                $err_msg[] = '購入日追加失敗';\n                            }\n                        \n                        // 在庫管理表(drink_stock_table)の更新日を更新\n                        $tostock_date_sql = \"UPDATE drink_stock_table SET 更新日 = '$date' WHERE ドリンクid = '$drink_id'\";\n                            if(!$result = mysqli_query($link,$tostock_date_sql)){\n                                $err_msg[] = '在庫表更新日更新失敗';\n                            }\n                            \n                        // 在庫管理表(drink_stock_table)の在庫から一つ引いた数で更新\n                        $tostock_stock_sql = \"UPDATE drink_stock_table SET 在庫数 = $stock WHERE ドリンクid = '$drink_id'\";\n                            if(!$result = mysqli_query($link,$tostock_stock_sql)){\n                                $err_msg[] = '在庫数更新失敗';\n                                \n                            }\n                    \n                        // 結果の表示\n                        print '<img src=\"./image/'.$image.'\">';\n                        print '<p>がしゃん!['.$drink_name.']が買えました！</p>';\n                        print '<p>おつりは['.$charge.'円]です</p>';\n                        \n                        }\n                    }\n                }\n            }else{\n                $err_msg[] = \"商品情報取得失敗\";\n            }\n            \n            // sqlでエラーがなければコミット\n            if(count($err_msg) === 0){\n                mysqli_commit($link);\n            }else {\n                mysqli_rollback($link);\n            }\n            \n            // 接続を閉じる\n            mysqli_close($link);\n        }else{\n            $err_msg[] = 'error:' . mysqli_connect_error();\n        }\n       \n    }\n    ?>\n        \n        \n        \n    </body>\n    <footer>\n        <a href=\"index.php\">戻る</a>\n    </footer>\n</html>","undoManager":{"mark":91,"position":100,"stack":[[{"start":{"row":95,"column":29},"end":{"row":95,"column":30},"action":"insert","lines":[" "],"id":125}],[{"start":{"row":95,"column":30},"end":{"row":95,"column":32},"action":"insert","lines":["''"],"id":126}],[{"start":{"row":95,"column":31},"end":{"row":95,"column":38},"action":"insert","lines":["売り切れました"],"id":127}],[{"start":{"row":95,"column":38},"end":{"row":95,"column":39},"action":"insert","lines":["！"],"id":128}],[{"start":{"row":96,"column":21},"end":{"row":96,"column":22},"action":"insert","lines":["e"],"id":129},{"start":{"row":96,"column":22},"end":{"row":96,"column":23},"action":"insert","lines":["l"]},{"start":{"row":96,"column":23},"end":{"row":96,"column":24},"action":"insert","lines":["s"]},{"start":{"row":96,"column":24},"end":{"row":96,"column":25},"action":"insert","lines":["e"]}],[{"start":{"row":96,"column":25},"end":{"row":96,"column":26},"action":"insert","lines":["{"],"id":130}],[{"start":{"row":95,"column":40},"end":{"row":95,"column":41},"action":"insert","lines":[";"],"id":131}],[{"start":{"row":129,"column":17},"end":{"row":130,"column":0},"action":"insert","lines":["",""],"id":132},{"start":{"row":130,"column":0},"end":{"row":130,"column":16},"action":"insert","lines":["                "]},{"start":{"row":130,"column":16},"end":{"row":130,"column":17},"action":"insert","lines":["}"]},{"start":{"row":130,"column":0},"end":{"row":130,"column":16},"action":"remove","lines":["                "]},{"start":{"row":130,"column":0},"end":{"row":130,"column":20},"action":"insert","lines":["                    "]}],[{"start":{"row":98,"column":0},"end":{"row":98,"column":4},"action":"insert","lines":["    "],"id":133},{"start":{"row":99,"column":0},"end":{"row":99,"column":4},"action":"insert","lines":["    "]},{"start":{"row":100,"column":0},"end":{"row":100,"column":4},"action":"insert","lines":["    "]},{"start":{"row":101,"column":0},"end":{"row":101,"column":4},"action":"insert","lines":["    "]},{"start":{"row":102,"column":0},"end":{"row":102,"column":4},"action":"insert","lines":["    "]},{"start":{"row":103,"column":0},"end":{"row":103,"column":4},"action":"insert","lines":["    "]},{"start":{"row":104,"column":0},"end":{"row":104,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":98,"column":0},"end":{"row":98,"column":4},"action":"insert","lines":["    "],"id":134},{"start":{"row":99,"column":0},"end":{"row":99,"column":4},"action":"insert","lines":["    "]},{"start":{"row":100,"column":0},"end":{"row":100,"column":4},"action":"insert","lines":["    "]},{"start":{"row":101,"column":0},"end":{"row":101,"column":4},"action":"insert","lines":["    "]},{"start":{"row":102,"column":0},"end":{"row":102,"column":4},"action":"insert","lines":["    "]},{"start":{"row":103,"column":0},"end":{"row":103,"column":4},"action":"insert","lines":["    "]},{"start":{"row":104,"column":0},"end":{"row":104,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":106,"column":0},"end":{"row":106,"column":4},"action":"insert","lines":["    "],"id":135},{"start":{"row":107,"column":0},"end":{"row":107,"column":4},"action":"insert","lines":["    "]},{"start":{"row":108,"column":0},"end":{"row":108,"column":4},"action":"insert","lines":["    "]},{"start":{"row":109,"column":0},"end":{"row":109,"column":4},"action":"insert","lines":["    "]},{"start":{"row":110,"column":0},"end":{"row":110,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":112,"column":0},"end":{"row":112,"column":4},"action":"insert","lines":["    "],"id":136},{"start":{"row":113,"column":0},"end":{"row":113,"column":4},"action":"insert","lines":["    "]},{"start":{"row":114,"column":0},"end":{"row":114,"column":4},"action":"insert","lines":["    "]},{"start":{"row":115,"column":0},"end":{"row":115,"column":4},"action":"insert","lines":["    "]},{"start":{"row":116,"column":0},"end":{"row":116,"column":4},"action":"insert","lines":["    "]},{"start":{"row":117,"column":0},"end":{"row":117,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":118,"column":0},"end":{"row":118,"column":4},"action":"insert","lines":["    "],"id":137},{"start":{"row":119,"column":0},"end":{"row":119,"column":4},"action":"insert","lines":["    "]},{"start":{"row":120,"column":0},"end":{"row":120,"column":4},"action":"insert","lines":["    "]},{"start":{"row":121,"column":0},"end":{"row":121,"column":4},"action":"insert","lines":["    "]},{"start":{"row":122,"column":0},"end":{"row":122,"column":4},"action":"insert","lines":["    "]},{"start":{"row":123,"column":0},"end":{"row":123,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":112,"column":26},"end":{"row":112,"column":27},"action":"remove","lines":[" "],"id":138}],[{"start":{"row":118,"column":24},"end":{"row":118,"column":28},"action":"remove","lines":["    "],"id":139}],[{"start":{"row":112,"column":26},"end":{"row":112,"column":27},"action":"remove","lines":[" "],"id":140},{"start":{"row":112,"column":25},"end":{"row":112,"column":26},"action":"remove","lines":[" "]}],[{"start":{"row":112,"column":24},"end":{"row":112,"column":25},"action":"remove","lines":[" "],"id":141}],[{"start":{"row":129,"column":0},"end":{"row":129,"column":4},"action":"insert","lines":["    "],"id":142}],[{"start":{"row":129,"column":0},"end":{"row":129,"column":4},"action":"insert","lines":["    "],"id":143}],[{"start":{"row":125,"column":0},"end":{"row":125,"column":4},"action":"insert","lines":["    "],"id":144},{"start":{"row":126,"column":0},"end":{"row":126,"column":4},"action":"insert","lines":["    "]},{"start":{"row":127,"column":0},"end":{"row":127,"column":4},"action":"insert","lines":["    "]},{"start":{"row":128,"column":0},"end":{"row":128,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":128,"column":60},"end":{"row":129,"column":0},"action":"insert","lines":["",""],"id":145},{"start":{"row":129,"column":0},"end":{"row":129,"column":24},"action":"insert","lines":["                        "]}],[{"start":{"row":94,"column":34},"end":{"row":94,"column":35},"action":"remove","lines":["'"],"id":146}],[{"start":{"row":94,"column":35},"end":{"row":94,"column":36},"action":"remove","lines":["'"],"id":147}],[{"start":{"row":95,"column":41},"end":{"row":96,"column":0},"action":"insert","lines":["",""],"id":148},{"start":{"row":96,"column":0},"end":{"row":96,"column":24},"action":"insert","lines":["                        "]}],[{"start":{"row":94,"column":37},"end":{"row":95,"column":0},"action":"insert","lines":["",""],"id":149},{"start":{"row":95,"column":0},"end":{"row":95,"column":24},"action":"insert","lines":["                        "]}],[{"start":{"row":93,"column":16},"end":{"row":93,"column":20},"action":"insert","lines":["    "],"id":150}],[{"start":{"row":93,"column":20},"end":{"row":93,"column":21},"action":"insert","lines":["v"],"id":151},{"start":{"row":93,"column":21},"end":{"row":93,"column":22},"action":"insert","lines":["a"]},{"start":{"row":93,"column":22},"end":{"row":93,"column":23},"action":"insert","lines":["r"]}],[{"start":{"row":93,"column":20},"end":{"row":93,"column":23},"action":"remove","lines":["var"],"id":152},{"start":{"row":93,"column":20},"end":{"row":93,"column":28},"action":"insert","lines":["var_dump"]}],[{"start":{"row":93,"column":28},"end":{"row":93,"column":30},"action":"insert","lines":["()"],"id":153}],[{"start":{"row":93,"column":29},"end":{"row":93,"column":30},"action":"insert","lines":["$"],"id":154},{"start":{"row":93,"column":30},"end":{"row":93,"column":31},"action":"insert","lines":["s"]},{"start":{"row":93,"column":31},"end":{"row":93,"column":32},"action":"insert","lines":["t"]},{"start":{"row":93,"column":32},"end":{"row":93,"column":33},"action":"insert","lines":["o"]}],[{"start":{"row":93,"column":33},"end":{"row":93,"column":34},"action":"insert","lines":["c"],"id":155},{"start":{"row":93,"column":34},"end":{"row":93,"column":35},"action":"insert","lines":["k"]}],[{"start":{"row":93,"column":36},"end":{"row":93,"column":37},"action":"insert","lines":[";"],"id":156}],[{"start":{"row":75,"column":64},"end":{"row":76,"column":0},"action":"insert","lines":["",""],"id":157},{"start":{"row":76,"column":0},"end":{"row":76,"column":20},"action":"insert","lines":["                    "]},{"start":{"row":76,"column":20},"end":{"row":77,"column":0},"action":"insert","lines":["",""]},{"start":{"row":77,"column":0},"end":{"row":77,"column":20},"action":"insert","lines":["                    "]}],[{"start":{"row":77,"column":20},"end":{"row":77,"column":35},"action":"insert","lines":[" // 購入したドリンク名取得"],"id":158}],[{"start":{"row":77,"column":34},"end":{"row":77,"column":35},"action":"remove","lines":["得"],"id":159},{"start":{"row":77,"column":33},"end":{"row":77,"column":34},"action":"remove","lines":["取"]},{"start":{"row":77,"column":32},"end":{"row":77,"column":33},"action":"remove","lines":["名"]},{"start":{"row":77,"column":31},"end":{"row":77,"column":32},"action":"remove","lines":["ク"]},{"start":{"row":77,"column":30},"end":{"row":77,"column":31},"action":"remove","lines":["ン"]},{"start":{"row":77,"column":29},"end":{"row":77,"column":30},"action":"remove","lines":["リ"]},{"start":{"row":77,"column":28},"end":{"row":77,"column":29},"action":"remove","lines":["ド"]}],[{"start":{"row":77,"column":28},"end":{"row":77,"column":33},"action":"insert","lines":["ドリンクの"],"id":160},{"start":{"row":77,"column":33},"end":{"row":77,"column":36},"action":"insert","lines":["在庫数"]}],[{"start":{"row":77,"column":36},"end":{"row":77,"column":38},"action":"insert","lines":["取得"],"id":161}],[{"start":{"row":78,"column":20},"end":{"row":78,"column":65},"action":"insert","lines":[" $status = htmlspecialchars($row['公開ステータス']);"],"id":162}],[{"start":{"row":78,"column":60},"end":{"row":78,"column":61},"action":"remove","lines":["ス"],"id":163},{"start":{"row":78,"column":59},"end":{"row":78,"column":60},"action":"remove","lines":["タ"]},{"start":{"row":78,"column":58},"end":{"row":78,"column":59},"action":"remove","lines":["ー"]},{"start":{"row":78,"column":57},"end":{"row":78,"column":58},"action":"remove","lines":["テ"]},{"start":{"row":78,"column":56},"end":{"row":78,"column":57},"action":"remove","lines":["ス"]},{"start":{"row":78,"column":55},"end":{"row":78,"column":56},"action":"remove","lines":["開"]},{"start":{"row":78,"column":54},"end":{"row":78,"column":55},"action":"remove","lines":["公"]}],[{"start":{"row":78,"column":54},"end":{"row":78,"column":57},"action":"insert","lines":["在庫数"],"id":164}],[{"start":{"row":78,"column":20},"end":{"row":78,"column":21},"action":"remove","lines":[" "],"id":165}],[{"start":{"row":77,"column":20},"end":{"row":77,"column":21},"action":"remove","lines":[" "],"id":166}],[{"start":{"row":78,"column":26},"end":{"row":78,"column":27},"action":"remove","lines":["s"],"id":167},{"start":{"row":78,"column":25},"end":{"row":78,"column":26},"action":"remove","lines":["u"]},{"start":{"row":78,"column":24},"end":{"row":78,"column":25},"action":"remove","lines":["t"]},{"start":{"row":78,"column":23},"end":{"row":78,"column":24},"action":"remove","lines":["a"]}],[{"start":{"row":78,"column":23},"end":{"row":78,"column":24},"action":"insert","lines":["o"],"id":168},{"start":{"row":78,"column":24},"end":{"row":78,"column":25},"action":"insert","lines":["c"]},{"start":{"row":78,"column":25},"end":{"row":78,"column":26},"action":"insert","lines":["k"]}],[{"start":{"row":93,"column":20},"end":{"row":93,"column":23},"action":"insert","lines":["// "],"id":169},{"start":{"row":94,"column":20},"end":{"row":94,"column":23},"action":"insert","lines":["// "]}],[{"start":{"row":78,"column":59},"end":{"row":79,"column":0},"action":"insert","lines":["",""],"id":170},{"start":{"row":79,"column":0},"end":{"row":79,"column":20},"action":"insert","lines":["                    "]}],[{"start":{"row":79,"column":20},"end":{"row":80,"column":42},"action":"insert","lines":["// 購入した商品画像取得","                    $image = $row['商品画像'];"],"id":171}],[{"start":{"row":79,"column":20},"end":{"row":80,"column":0},"action":"insert","lines":["",""],"id":172},{"start":{"row":80,"column":0},"end":{"row":80,"column":20},"action":"insert","lines":["                    "]}],[{"start":{"row":93,"column":20},"end":{"row":93,"column":23},"action":"insert","lines":["// "],"id":173},{"start":{"row":94,"column":20},"end":{"row":94,"column":23},"action":"insert","lines":["// "]}],[{"start":{"row":99,"column":33},"end":{"row":99,"column":34},"action":"remove","lines":[" "],"id":176},{"start":{"row":99,"column":32},"end":{"row":99,"column":33},"action":"remove","lines":["="]},{"start":{"row":99,"column":31},"end":{"row":99,"column":32},"action":"remove","lines":["="]},{"start":{"row":99,"column":30},"end":{"row":99,"column":31},"action":"remove","lines":["="]}],[{"start":{"row":99,"column":30},"end":{"row":99,"column":31},"action":"insert","lines":["<"],"id":177}],[{"start":{"row":99,"column":31},"end":{"row":99,"column":32},"action":"insert","lines":[" "],"id":178}],[{"start":{"row":99,"column":30},"end":{"row":99,"column":31},"action":"insert","lines":["="],"id":179}],[{"start":{"row":99,"column":31},"end":{"row":99,"column":32},"action":"remove","lines":["<"],"id":180},{"start":{"row":99,"column":30},"end":{"row":99,"column":31},"action":"remove","lines":["="]}],[{"start":{"row":99,"column":30},"end":{"row":99,"column":31},"action":"insert","lines":["<"],"id":181},{"start":{"row":99,"column":31},"end":{"row":99,"column":32},"action":"insert","lines":["="]}],[{"start":{"row":81,"column":42},"end":{"row":82,"column":0},"action":"insert","lines":["",""],"id":182},{"start":{"row":82,"column":0},"end":{"row":82,"column":20},"action":"insert","lines":["                    "]},{"start":{"row":82,"column":20},"end":{"row":83,"column":0},"action":"insert","lines":["",""]},{"start":{"row":83,"column":0},"end":{"row":83,"column":20},"action":"insert","lines":["                    "]}],[{"start":{"row":82,"column":20},"end":{"row":83,"column":0},"action":"insert","lines":["",""],"id":183},{"start":{"row":83,"column":0},"end":{"row":83,"column":20},"action":"insert","lines":["                    "]},{"start":{"row":83,"column":20},"end":{"row":83,"column":21},"action":"insert","lines":["$"]},{"start":{"row":83,"column":21},"end":{"row":83,"column":22},"action":"insert","lines":["p"]}],[{"start":{"row":83,"column":22},"end":{"row":83,"column":23},"action":"insert","lines":["r"],"id":184},{"start":{"row":83,"column":23},"end":{"row":83,"column":24},"action":"insert","lines":["i"]},{"start":{"row":83,"column":24},"end":{"row":83,"column":25},"action":"insert","lines":["c"]},{"start":{"row":83,"column":25},"end":{"row":83,"column":26},"action":"insert","lines":["e"]}],[{"start":{"row":83,"column":26},"end":{"row":83,"column":27},"action":"insert","lines":[" "],"id":185},{"start":{"row":83,"column":27},"end":{"row":83,"column":28},"action":"insert","lines":["="]}],[{"start":{"row":83,"column":28},"end":{"row":83,"column":29},"action":"insert","lines":[" "],"id":186},{"start":{"row":83,"column":29},"end":{"row":83,"column":30},"action":"insert","lines":["$"]}],[{"start":{"row":83,"column":30},"end":{"row":83,"column":31},"action":"insert","lines":["r"],"id":187},{"start":{"row":83,"column":31},"end":{"row":83,"column":32},"action":"insert","lines":["o"]}],[{"start":{"row":83,"column":29},"end":{"row":83,"column":32},"action":"remove","lines":["$ro"],"id":188},{"start":{"row":83,"column":29},"end":{"row":83,"column":33},"action":"insert","lines":["$row"]}],[{"start":{"row":83,"column":33},"end":{"row":83,"column":35},"action":"insert","lines":["[]"],"id":189}],[{"start":{"row":83,"column":34},"end":{"row":83,"column":36},"action":"insert","lines":["''"],"id":190}],[{"start":{"row":83,"column":35},"end":{"row":83,"column":36},"action":"insert","lines":["k"],"id":191},{"start":{"row":83,"column":36},"end":{"row":83,"column":37},"action":"insert","lines":["a"]},{"start":{"row":83,"column":37},"end":{"row":83,"column":38},"action":"insert","lines":["k"]},{"start":{"row":83,"column":38},"end":{"row":83,"column":39},"action":"insert","lines":["a"]}],[{"start":{"row":83,"column":38},"end":{"row":83,"column":39},"action":"remove","lines":["a"],"id":192},{"start":{"row":83,"column":37},"end":{"row":83,"column":38},"action":"remove","lines":["k"]},{"start":{"row":83,"column":36},"end":{"row":83,"column":37},"action":"remove","lines":["a"]},{"start":{"row":83,"column":35},"end":{"row":83,"column":36},"action":"remove","lines":["k"]}],[{"start":{"row":83,"column":35},"end":{"row":83,"column":37},"action":"insert","lines":["価格"],"id":193}],[{"start":{"row":83,"column":39},"end":{"row":83,"column":40},"action":"insert","lines":[";"],"id":194}],[{"start":{"row":94,"column":57},"end":{"row":94,"column":58},"action":"remove","lines":["]"],"id":195},{"start":{"row":94,"column":56},"end":{"row":94,"column":57},"action":"remove","lines":["'"]},{"start":{"row":94,"column":55},"end":{"row":94,"column":56},"action":"remove","lines":["格"]},{"start":{"row":94,"column":54},"end":{"row":94,"column":55},"action":"remove","lines":["価"]},{"start":{"row":94,"column":53},"end":{"row":94,"column":54},"action":"remove","lines":["'"]},{"start":{"row":94,"column":52},"end":{"row":94,"column":53},"action":"remove","lines":["["]},{"start":{"row":94,"column":51},"end":{"row":94,"column":52},"action":"remove","lines":["w"]},{"start":{"row":94,"column":50},"end":{"row":94,"column":51},"action":"remove","lines":["o"]},{"start":{"row":94,"column":49},"end":{"row":94,"column":50},"action":"remove","lines":["r"]}],[{"start":{"row":94,"column":49},"end":{"row":94,"column":50},"action":"insert","lines":["p"],"id":196},{"start":{"row":94,"column":50},"end":{"row":94,"column":51},"action":"insert","lines":["r"]},{"start":{"row":94,"column":51},"end":{"row":94,"column":52},"action":"insert","lines":["i"]},{"start":{"row":94,"column":52},"end":{"row":94,"column":53},"action":"insert","lines":["c"]},{"start":{"row":94,"column":53},"end":{"row":94,"column":54},"action":"insert","lines":["e"]}],[{"start":{"row":82,"column":20},"end":{"row":83,"column":0},"action":"insert","lines":["",""],"id":197},{"start":{"row":83,"column":0},"end":{"row":83,"column":20},"action":"insert","lines":["                    "]}],[{"start":{"row":83,"column":20},"end":{"row":83,"column":34},"action":"insert","lines":[" // 購入した商品画像取得"],"id":198}],[{"start":{"row":83,"column":31},"end":{"row":83,"column":32},"action":"remove","lines":["像"],"id":199},{"start":{"row":83,"column":30},"end":{"row":83,"column":31},"action":"remove","lines":["画"]}],[{"start":{"row":83,"column":30},"end":{"row":83,"column":32},"action":"insert","lines":["価格"],"id":200}],[{"start":{"row":77,"column":37},"end":{"row":77,"column":38},"action":"insert","lines":["　"],"id":201}],[{"start":{"row":77,"column":38},"end":{"row":77,"column":51},"action":"insert","lines":["修正箇所　12/2/'21"],"id":202}],[{"start":{"row":80,"column":33},"end":{"row":80,"column":34},"action":"insert","lines":["　"],"id":203}],[{"start":{"row":80,"column":34},"end":{"row":80,"column":47},"action":"insert","lines":["修正箇所　12/2/'21"],"id":204}],[{"start":{"row":83,"column":34},"end":{"row":83,"column":35},"action":"insert","lines":["　"],"id":205}],[{"start":{"row":83,"column":35},"end":{"row":83,"column":48},"action":"insert","lines":["修正箇所　12/2/'21"],"id":206}],[{"start":{"row":87,"column":16},"end":{"row":88,"column":0},"action":"insert","lines":["",""],"id":207},{"start":{"row":88,"column":0},"end":{"row":88,"column":16},"action":"insert","lines":["                "]}],[{"start":{"row":88,"column":16},"end":{"row":88,"column":23},"action":"insert","lines":["公開ステータス"],"id":208},{"start":{"row":88,"column":23},"end":{"row":88,"column":24},"action":"insert","lines":["が"]}],[{"start":{"row":88,"column":24},"end":{"row":88,"column":30},"action":"insert","lines":["非公開の場合"],"id":209}],[{"start":{"row":88,"column":16},"end":{"row":88,"column":19},"action":"insert","lines":["// "],"id":210}],[{"start":{"row":88,"column":33},"end":{"row":88,"column":39},"action":"insert","lines":["購入できない"],"id":211}],[{"start":{"row":88,"column":39},"end":{"row":88,"column":40},"action":"insert","lines":["　"],"id":212}],[{"start":{"row":88,"column":40},"end":{"row":88,"column":53},"action":"insert","lines":["修正箇所　12/2/'21"],"id":213}],[{"start":{"row":98,"column":18},"end":{"row":102,"column":44},"action":"remove","lines":["  // // 購入した商品画像取得","                    // $image = $row['商品画像'];","                        ","                    // // 購入した商品の現在在庫数取得","                    // $stock = $row['在庫数'];"],"id":214},{"start":{"row":98,"column":17},"end":{"row":98,"column":18},"action":"remove","lines":[" "]},{"start":{"row":98,"column":16},"end":{"row":98,"column":17},"action":"remove","lines":[" "]},{"start":{"row":98,"column":12},"end":{"row":98,"column":16},"action":"remove","lines":["    "]},{"start":{"row":98,"column":8},"end":{"row":98,"column":12},"action":"remove","lines":["    "]},{"start":{"row":98,"column":4},"end":{"row":98,"column":8},"action":"remove","lines":["    "]},{"start":{"row":98,"column":0},"end":{"row":98,"column":4},"action":"remove","lines":["    "]}],[{"start":{"row":97,"column":24},"end":{"row":98,"column":0},"action":"remove","lines":["",""],"id":215}],[{"start":{"row":98,"column":36},"end":{"row":98,"column":37},"action":"remove","lines":[";"],"id":216},{"start":{"row":98,"column":35},"end":{"row":98,"column":36},"action":"remove","lines":[")"]},{"start":{"row":98,"column":34},"end":{"row":98,"column":35},"action":"remove","lines":["k"]},{"start":{"row":98,"column":33},"end":{"row":98,"column":34},"action":"remove","lines":["c"]},{"start":{"row":98,"column":32},"end":{"row":98,"column":33},"action":"remove","lines":["o"]},{"start":{"row":98,"column":31},"end":{"row":98,"column":32},"action":"remove","lines":["t"]},{"start":{"row":98,"column":30},"end":{"row":98,"column":31},"action":"remove","lines":["s"]},{"start":{"row":98,"column":29},"end":{"row":98,"column":30},"action":"remove","lines":["$"]},{"start":{"row":98,"column":28},"end":{"row":98,"column":29},"action":"remove","lines":["("]},{"start":{"row":98,"column":27},"end":{"row":98,"column":28},"action":"remove","lines":["p"]},{"start":{"row":98,"column":26},"end":{"row":98,"column":27},"action":"remove","lines":["m"]},{"start":{"row":98,"column":25},"end":{"row":98,"column":26},"action":"remove","lines":["u"]}],[{"start":{"row":98,"column":24},"end":{"row":98,"column":25},"action":"remove","lines":["d"],"id":217},{"start":{"row":98,"column":23},"end":{"row":98,"column":24},"action":"remove","lines":["_"]},{"start":{"row":98,"column":22},"end":{"row":98,"column":23},"action":"remove","lines":["r"]},{"start":{"row":98,"column":21},"end":{"row":98,"column":22},"action":"remove","lines":["a"]},{"start":{"row":98,"column":20},"end":{"row":98,"column":21},"action":"remove","lines":["v"]},{"start":{"row":98,"column":16},"end":{"row":98,"column":20},"action":"remove","lines":["    "]},{"start":{"row":98,"column":12},"end":{"row":98,"column":16},"action":"remove","lines":["    "]},{"start":{"row":98,"column":8},"end":{"row":98,"column":12},"action":"remove","lines":["    "]},{"start":{"row":98,"column":4},"end":{"row":98,"column":8},"action":"remove","lines":["    "]}],[{"start":{"row":98,"column":0},"end":{"row":98,"column":4},"action":"remove","lines":["    "],"id":218},{"start":{"row":97,"column":24},"end":{"row":98,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":97,"column":24},"end":{"row":98,"column":0},"action":"insert","lines":["",""],"id":219},{"start":{"row":98,"column":0},"end":{"row":98,"column":24},"action":"insert","lines":["                        "]}],[{"start":{"row":98,"column":20},"end":{"row":98,"column":23},"action":"insert","lines":["在庫数"],"id":220},{"start":{"row":98,"column":23},"end":{"row":98,"column":24},"action":"insert","lines":["が"]}],[{"start":{"row":98,"column":24},"end":{"row":98,"column":25},"action":"insert","lines":["0"],"id":221}],[{"start":{"row":98,"column":25},"end":{"row":98,"column":26},"action":"insert","lines":["個"],"id":222}],[{"start":{"row":98,"column":26},"end":{"row":98,"column":31},"action":"insert","lines":["以下の場合"],"id":223}],[{"start":{"row":98,"column":31},"end":{"row":98,"column":37},"action":"insert","lines":["購入できない"],"id":224}],[{"start":{"row":98,"column":37},"end":{"row":98,"column":38},"action":"insert","lines":["　"],"id":225}],[{"start":{"row":98,"column":38},"end":{"row":98,"column":51},"action":"insert","lines":["修正箇所　12/2/'21"],"id":226}],[{"start":{"row":98,"column":20},"end":{"row":98,"column":23},"action":"insert","lines":["// "],"id":227}]]},"ace":{"folds":[],"scrolltop":996.5,"scrollleft":0,"selection":{"start":{"row":104,"column":16},"end":{"row":104,"column":16},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":13,"state":"start","mode":"ace/mode/php"}},"timestamp":1638411903532}